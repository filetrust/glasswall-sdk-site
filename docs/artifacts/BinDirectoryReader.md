---
title: Bin directory reader
---

\section Author
Steven Warner,
Roman Danilov

\section Description
Tests directory full of files against a BDDL definition as a way of confirming that it will generate identical file once translated to C++.

\section Location
Scripts can be found at the following location in TFS


- inhouse.tools\\GWBinaryAnalysisTools\\BinDirectoryReader


\section Usage


Requirements of BinDirectoryReader
==================================

Take BinReader Example from Miraplacid as base.

Add means of taking options from the commandline in the form "-option value"

Options to include:
-------------------
* Name of filepath 
- where search for files will start and work down recursively e.g. c:\file_archive\docfiles

* Name of file or wildcard
- full name of file to find instances of in the search or partial filename with wildcards 
e.g. sttb.bin or plc*.bin or wordcorestreams.bin

* Name of BDDL schema to parse
- full filepath and name for the schema that matches the binary files being sought


* Output path for rebuilt binaries

* Output path for debug files

* Option to generate rebuilt binaries even if unrequired



Operation
---------

* Load the options
* Load the schema file and asks the Miraplacid SDK (MP) to try to parse it. Stops with error if that fails.
* Start searching the directory for the matching files.
* Foreach binary file ...
  * Get MP to try to parse the file into a MP Binary DOM tree. Skip to next file with error if that fails, with output of reason for failure. 
  * If the file loads into the BinDOM tree, get MP to rewrite the tree to a binary form into a memorybuffer (memorystream/bytearray) and comparing it to the original 
    binary file that was input.
    If that does not match, report the error and output the created binary file to the output path for rebuilt binaries 
    (prepended with the full path for the original file minus the leading drive name)
  * If required by options (Option to generate rebuilt binaries even if unrequired),
    output the recreated binary file to the output path for rebuilt binaries regardless of whether it passed
    (prepended with the full path for the original file minus the leading drive name)
  * If required by options (Output path for debug files),
    Output the debug report for the file - generated by MP in the form of a text version of the files' tree structure.