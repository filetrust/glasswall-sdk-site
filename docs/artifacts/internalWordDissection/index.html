<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165717322-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-165717322-1",{})</script>
<script src="/glasswall-sdk-site/js/fix-location.js"></script><title data-react-helmet="true">internalWordDissection | Glasswall Documentation</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="internalWordDissection | Glasswall Documentation"><meta data-react-helmet="true" name="description" content="Word Dissection {#internalWordDissection}"><meta data-react-helmet="true" property="og:description" content="Word Dissection {#internalWordDissection}"><meta data-react-helmet="true" property="og:url" content="https://filetrust.github.io/glasswall-sdk-site/docs/artifacts/internalWordDissection"><link data-react-helmet="true" rel="shortcut icon" href="/glasswall-sdk-site/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://filetrust.github.io/glasswall-sdk-site/docs/artifacts/internalWordDissection"><link rel="stylesheet" href="/glasswall-sdk-site/styles.6fa2c0dc.css">
<link rel="preload" href="/glasswall-sdk-site/styles.c6758ed4.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/runtime~main.6361f672.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/main.535b752c.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/1.7246c598.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/2.39ec2498.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/167.fe7c77d7.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/168.06b53c5c.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/935f2afb.7682735c.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/17896441.be3a2305.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/0267e96a.ebb0ad25.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/glasswall-sdk-site/"><img class="navbar__logo" src="/glasswall-sdk-site/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">Glasswall Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/glasswall-sdk-site/docs/1-introduction">Documents</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/filetrust" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/glasswall-sdk-site/"><img class="navbar__logo" src="/glasswall-sdk-site/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">Glasswall Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/glasswall-sdk-site/docs/1-introduction">Documents</a></li><li class="menu__list-item"><a href="https://github.com/filetrust" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">internalWordDissection</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="word-dissection-internalworddissection"></a>Word Dissection {#internalWordDissection}<a aria-hidden="true" tabindex="-1" class="hash-link" href="#word-dissection-internalworddissection" title="Direct link to heading">#</a></h1><p>\section Author</p><p>Steve Warner </p><p>\section Description</p><p>Extracts structure and stream components from a word binary file and stores them as separate binary files, data which can then be used to test/validate BDD structure definitions.</p><p>\section Location
Can be found at the following location in TFS:</p><ul><li>inhouse.tools\GWBinaryAnalysisTools\MSOfficeAnalysis\MSWordAnalysis\WordDocumentStreamWalker\WordDissection\bin\Release\WordDissection.exe</li></ul><p>\section Usage</p><p>WordDissection </p><p>Version: 1.8.3</p><p>Usage:</p><p>WordDissection <em>directoryToProcess</em> <em>command</em>
where <em>directoryToProcess</em> is processed and all its subdirectories. These directories need to have had <em>walkCFB</em> run on them already and contain WordDocument.bin and 1Table.bin and/or 0Table.bin and optionally data.bin.</p><p>where <em>command</em> is one or more of these</p><p>h - get headings</p><p>d - get blob info</p><p>t - split table into substreams</p><p>c - create core file from wds/table/data streams</p><p>o - overwrite - write files even if they already exist</p><p>v - verbose messages during execution</p><p>e.g.: </p><p>WordDissection c:/testfiles tc</p><p>will create TableStream subdirectory and its contents and the core stream binary for every *.doc directory in c:/testfiles</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="worddissection-specification"></a>WordDissection Specification<a aria-hidden="true" tabindex="-1" class="hash-link" href="#worddissection-specification" title="Direct link to heading">#</a></h1><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="phase-1"></a>Phase 1<a aria-hidden="true" tabindex="-1" class="hash-link" href="#phase-1" title="Direct link to heading">#</a></h1><p>Requirement:</p><p>Search directories previously processed by WalkCFB (with -streams option) looking for the binaries created from the streams withing CFB files.</p><p>Taking Miraplacid Binary Reader sample as a base. Create a program that looks in the current directory and all its subdirectories.
If it finds a WordDocument.bin and at least a 1Table.bin or 0Table.bin file it begins processing the files.</p><p>It has several options.</p><p>Firstly it uses a copy of the WordDocument.bdd file as a schema (added as a resource to the program project) to dissect the WordDocumentStream.bin file.</p><p>With the Bin-DOM tree generated, it searches for the base.fWhichTblStm flag and determines whether to use the 1Table.bin or 0Table.bin  as the TableStream of choice</p><p>With the Bin-DOM tree generated, it loops through the Blob looking for all the fc/lcb pairs.</p><p>The &#x27;H&#x27; option sends a comma separated list of the fc headers to the standard output
The &#x27;D&#x27; option sends a comma separated list of the lcb sizesto the standard output</p><p>These are put together into text files for processing in Excel to build statistics about the Table Stream</p><p>The &#x27;T&#x27; option creates a subdirectory called TableStream and writes a binary file for each fc/lcb pair (using the names in the Bin-DOM tree that came from the  WordDocument.bdd). The binary file is extracted from the TableStream at the fc offset for thr lcb number of bytes.</p><p>The &#x27;C&#x27; option creates the WordCoreStreams.bin file by concatenating the chosen Tablestream the Data stream (optional stream) and theWordDocumentStream.bin.
It will prefix this with  three 32 bit size fields for the size of each stream in the same order they are written.
This conform with the WordCoreStreams.bdd file.</p><p>The &#x27;O&#x27; option overwrites the output files if they already exist - but it doesnt change Read Only files.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="phase-2"></a>Phase 2<a aria-hidden="true" tabindex="-1" class="hash-link" href="#phase-2" title="Direct link to heading">#</a></h1><p>Requirement:</p><p>Change commandline options to use &quot;-name&quot; form</p><p>H becomes -h or --headers
D becomes -d or --data
T becomes -t or --table
C becomes -c or --core
O becomes -o or --overrite</p><p>New Option </p><p>-w or --odraw</p><p>For every directory being processed.
Bring WordCoreStreams.BDD into the program as a resource.
Parse WordCoreStreams.bin into a Bin-DOM tree </p><p>Search through PLCs for a sprmCFSpec and sprmCPicLocation applied to the same CP
Using the rule defined in MS-DOC 1.3.5 Pictures, determine the offset into the Data stream where a PICFAndOfficeArtData object starts (which contains a header which determines the size of the object - a PICFAndOfficeArtData.bdd will be required for this)</p><p>PlcSpa (MS-DOC 2.9.253 Spa) also references a shape via the OfficeArtDggContainer. This should resolve to further ODraw data that could be extracted to a separate binary files.</p><p>When these objects are found, they should be written to a subdirectory called &#x27;DataStream&#x27; in the form &#x27;Odraw_<em>data stream offset</em>.bin</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/glasswall-sdk-site/docs/products/cloud-sdk/rebuild/rebuild-quickstart">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/glasswall" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/filetrust" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/glasswallglobal" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/glasswall-solutions-limited/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Glasswall Solutions Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/glasswall-sdk-site/styles.c6758ed4.js"></script>
<script src="/glasswall-sdk-site/runtime~main.6361f672.js"></script>
<script src="/glasswall-sdk-site/main.535b752c.js"></script>
<script src="/glasswall-sdk-site/1.7246c598.js"></script>
<script src="/glasswall-sdk-site/2.39ec2498.js"></script>
<script src="/glasswall-sdk-site/167.fe7c77d7.js"></script>
<script src="/glasswall-sdk-site/168.06b53c5c.js"></script>
<script src="/glasswall-sdk-site/935f2afb.7682735c.js"></script>
<script src="/glasswall-sdk-site/17896441.be3a2305.js"></script>
<script src="/glasswall-sdk-site/0267e96a.ebb0ad25.js"></script>
</body>
</html>