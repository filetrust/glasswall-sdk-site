<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165717322-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-165717322-1",{})</script>
<script src="/glasswall-sdk-site/js/fix-location.js"></script>
<script src="/glasswall-sdk-site/js/hide-artifacts.js"></script><title data-react-helmet="true">BDDL hints and Tips | Glasswall Documentation</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="BDDL hints and Tips | Glasswall Documentation"><meta data-react-helmet="true" name="description" content="1. Introduction"><meta data-react-helmet="true" property="og:description" content="1. Introduction"><meta data-react-helmet="true" property="og:url" content="https://filetrust.github.io/glasswall-sdk-site/docs/artifacts/BddlhintsAndTips"><link data-react-helmet="true" rel="shortcut icon" href="/glasswall-sdk-site/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://filetrust.github.io/glasswall-sdk-site/docs/artifacts/BddlhintsAndTips"><link rel="stylesheet" href="/glasswall-sdk-site/styles.795ebcef.css">
<link rel="preload" href="/glasswall-sdk-site/styles.d9e35366.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/runtime~main.0a1c7a3c.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/main.bca24aa5.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/1.b6c50131.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/2.afa770ea.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/159.dc6f6e54.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/160.57ee4261.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/935f2afb.168c9da0.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/17896441.61f115df.js" as="script">
<link rel="preload" href="/glasswall-sdk-site/c30c321f.2aa2b98f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/glasswall-sdk-site/"><img class="navbar__logo" src="/glasswall-sdk-site/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">Glasswall Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/glasswall-sdk-site/docs/1-introduction">Documents</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/filetrust" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/glasswall-sdk-site/"><img class="navbar__logo" src="/glasswall-sdk-site/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">Glasswall Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/glasswall-sdk-site/docs/1-introduction">Documents</a></li><li class="menu__list-item"><a href="https://github.com/filetrust" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">BDDL hints and Tips</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="1-introduction"></a>1. Introduction<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-introduction" title="Direct link to heading">#</a></h2><p>This document is for use by the BDDL developers. If there are any
tips and hints you want to pass on to your colleagues then enter
them in here.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="2-example-format"></a>2. Example Format<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-example-format" title="Direct link to heading">#</a></h2><p>Here&#x27;s a suggestion for the format:</p><p>AUTHOR: Julie Noted<br>
DATE: 12 July 2013<br>
TIP: When writing a restriction and you want to test if a bit
is set, DO NOT compare with 1, for example</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">... optional restrictions { fABCD &amp; 0x7 == 1 }   &lt;-- WRONG</span></div></div></div></div></div><p>use this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">... optional restrictions { fABCD &amp; 0x7 }</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="3-developer-hints-and-tips"></a>3. Developer Hints and Tips<a aria-hidden="true" tabindex="-1" class="hash-link" href="#3-developer-hints-and-tips" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="31---table-binaries-and-type--item-construct"></a>3.1 - Table Binaries and &quot;type [*] item&quot; construct<a aria-hidden="true" tabindex="-1" class="hash-link" href="#31---table-binaries-and-type--item-construct" title="Direct link to heading">#</a></h3><p>AUTHOR: Steven Warner</p><p>No Table section is self contained. I should have made this clearer from the outset. The binary files of the form <code>fibRgFcLcb</code><em>nnnn</em>.<em>AAAA</em><code>.bin</code> (e.g. <code>fibRgFcLcb97.Clx.bin</code>) are extracted from the <code>1Table.bin</code> file, which is a stream extracted from the CFB file in which the entire Office file is stored.</p><p>These are extracted for Development Purposes only!</p><p>So the actual storage of the separate <code>fibRgFcLcb</code><em>nnnn</em>.<em>AAAA</em><code>.bin</code>
files is more like this.</p><p><code>1Table.bin</code> contains:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.Clx.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.Cmds.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.DggInfo.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.Dop.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfBteChpx.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfBteLvc.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfBtePapx.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfFldMom.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfFldTxbx.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfSed.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfSpl.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcfTxbxBkd.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcftxbxTxt.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlcSpaMom.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlfLfo.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.PlfLst.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.Stshf.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.StshfOrig.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.SttbfAssoc.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.SttbfFfn.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.SttbListNames.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.SttbSavedBy.bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">fibRgFcLcb97.Wss.bin</span></div></div></div></div></div><p>Which means you cannot make any assumptions about being able to use
the <code>[*]</code> array range in these files, because they actually live inside
a larger structure in the real file and the <code>[*]</code> mechanism will
incorrectly keep going into the following structures.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="32-about-the-usage-of-restrictions-and-acceptrule-on-arrays"></a>3.2 About the usage of &#x27;restrictions&#x27; and &#x27;AcceptRule&#x27; on arrays<a aria-hidden="true" tabindex="-1" class="hash-link" href="#32-about-the-usage-of-restrictions-and-acceptrule-on-arrays" title="Direct link to heading">#</a></h3><p>AUTHOR: Elvin Barreto-White</p><p>It is best to use <code>AcceptRule</code> in an array of a structure type as
opposed to <code>restrictions</code> on the array.</p><p>Example</p><p>Avoid doing this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct Example {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 Size;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    StructType [Size] data optional restrictions {parent.Size == 0x50};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint64 [15] MoreStuff;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct StructType {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 A;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 B;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 z;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>Do this instead:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct Example {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 Size;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    StructType [Size] data optional;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint64 [15] MoreStuff;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct StructType {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    AcceptRule parent.Size == 0x50;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 A;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 B;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 z;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>In an array data item, the restrictions clause will be applied to
each element, so if there&#x27;s a sentinel value in the array (for
example), then the restrictions clause can be used on an array.</p><p>Consider this:</p><p>Example</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct WhiteSpace {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    char[*] str optional restrictions {iswhitespace()};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>Here, <code>str</code>, will be the number of characters up to, but not including,
any character that is not whitespace.</p><p>or</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct equalsZero {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8[15] padding optional restrictions {current == 0};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>Here the <code>padding</code> field will stop processing if it encounter a value
that is not 0.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="33-using-allowempty"></a>3.3 Using &#x27;allowempty&#x27;<a aria-hidden="true" tabindex="-1" class="hash-link" href="#33-using-allowempty" title="Direct link to heading">#</a></h3><p>AUTHOR: unknown</p><p>Use <code>allowempty</code> on arrays that may or can be empty. It may be best
to apply it to all arrays, unless the specification says otherwise.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="34-bit-masking"></a>3.4 Bit Masking<a aria-hidden="true" tabindex="-1" class="hash-link" href="#34-bit-masking" title="Direct link to heading">#</a></h3><p>AUTHOR: Jose Alonso</p><p>For a detailed introduction to bit masking, go to the BDDL
Development page in the Wiki ---&gt; Presentation Notes ---&gt; <a href="/glasswall-sdk-site/docs/artifacts/TODO">Bits and
Pieces (Valid link pending)</a>, written by Martin O\&#x27;Brien.</p><p>Let&#x27;s suppose we have a one-byte variable, called <code>var_name</code>, equal
to ABCDEFGH (binary). If we want to know the value of the second bit,
G (LSB being H), a way of doing it is as follows:</p><p>Example</p><p>We reset the other bits (we set them to zero). The binary number used
in this operation is called a mask. In this example, the mask would
be 00000010 (binary), which is 0x02 (hexadecimal).</p><p>This is implemented as follows:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(var_name &amp; 0x02)</span></div></div></div></div></div><p>The result of this operation is either zero or two, depending on the
value of the G flag.</p><p>The bit-masking expression MUST be enclosed in parentheses.</p><p>This is probably not what you want to:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">AcceptRule parent.fEFGHIJKL &amp; 0x80 == 0x80;</span></div></div></div></div></div><p>Do this instead:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">AcceptRule (parent.fEFGHIJKL &amp; 0x80) == 0x80; </span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="35-where-you-have-a-string-defined-in-the-bdd-file"></a>3.5 Where you have a string defined in the BDD file<a aria-hidden="true" tabindex="-1" class="hash-link" href="#35-where-you-have-a-string-defined-in-the-bdd-file" title="Direct link to heading">#</a></h3><p>AUTHOR: unknown</p><p>You should use one of the standard strings in <code>common/plex.bdd</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="36-about-the-usage-of-optional"></a>3.6 About the usage of &#x27;optional&#x27;<a aria-hidden="true" tabindex="-1" class="hash-link" href="#36-about-the-usage-of-optional" title="Direct link to heading">#</a></h3><p>AUTHOR: Jose Alonso</p><p>If the <code>optional</code> keyword is used, a condition should be always used,
otherwise, <code>optional</code> is useless.</p><p>Example</p><p>Avoid doing this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct myStruct {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    STD std;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 padding optional;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>Do this instead:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct Padding {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">AcceptRule (sizeof(std) % 2) != 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct myStruct {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    STD std;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Padding padding optional;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="37-accessing-a-specific-element-of-an-array"></a>3.7 Accessing a specific element of an array<a aria-hidden="true" tabindex="-1" class="hash-link" href="#37-accessing-a-specific-element-of-an-array" title="Direct link to heading">#</a></h3><p>AUTHOR: Roman Danilov</p><p>It is possible to access specific element of an array with the square
bracket notation as you would in many programming languages:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[comment=&quot;Fetches the first element of the aCP array&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">aCP[0];</span></div></div></div></div></div><p>It is also possible to access a specific substructure from a specific
element of the array. For example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct CharCount {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 count;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">document ParagraphDocument {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CharCount[5] charCount;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [comment=&quot;Accesses the first element of the charCount array and uses its count substructure to specify the size of the array&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    char[charCount[0].count] word1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    char[charCount[1].count] word2;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="38-accessing-ms-odraw-structures"></a>3.8 Accessing MS-ODRAW structures<a aria-hidden="true" tabindex="-1" class="hash-link" href="#38-accessing-ms-odraw-structures" title="Direct link to heading">#</a></h3><p>AUTHOR: Roman Danilov</p><p>All the properties are stored in a structure called <code>OfficeArtRGFOPTE</code>
alongside their corresponding complex structure. <code>OfficeArtRGFOPTE</code> is
made up of two arrays. The first array stores the properties, made up
of an <code>OfficeArtFOPTEOPID</code> followed by a 4 byte data field. The second
array stores the corresponding complex structures when the <code>fComplex</code>
bit is set.</p><p>In order to access the property to check whether the <code>fComplex</code>, or
any other bit, is set you could do something similar to this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">parent.rgfopte[type() == &quot;ThreeD_StyleBooleanProperties&quot;].F == 0x0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ? ... </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    : ...;</span></div></div></div></div></div><p>In this example we are checking whether the <code>F</code> (<code>fc3DConstrainRotation</code>)
bit from the <em>3D-Style Boolean Properties</em> property is set (<em>3D-Style
Boolean Properties</em> is renamed to <code>ThreeD_StyleBooleanProperties</code>
to keep the DVL checker and Miraplacid happy). The square bracket
notation is used to find the <code>ThreeD_StyleBooleanProperties</code> structure
and then access the <code>F</code> (<code>fc3DConstrainRotation</code>) field. This should
mostly work as long as there exists only one property of a specific
type in the array (from the data we have seen, this seems to be the
case). Replace the <code>ThreeD_StyleBooleanProperties</code> with your own
structure that you need to access and <code>.F</code> with the field that you
need to access.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="39-accessing-ms-odraw-structures-further-explanation"></a>3.9 Accessing MS-ODRAW structures: Further explanation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#39-accessing-ms-odraw-structures-further-explanation" title="Direct link to heading">#</a></h3><p>AUTHOR: Jose Alonso</p><p><code>rgfopte</code> is an array of <code>OfficeArtFOPTE</code> records, which specifies
property table entries (page 97 of <em>[MS-ODRAW]</em>).</p><p>If we have</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rgfopte[0] = &quot;c3DFillX&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rgfopte[1] = &quot;c3DFillY&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rgfopte[2] = &quot;c3DFillZ&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rgfopte[3] = &quot;ThreeD_StyleBooleanProperties&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div></div></div></div></div><p>and we want to access the element containing the
<code>ThreeD_StyleBooleanProperties</code> structure, we can do the following</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rgfopte[3]</span></div></div></div></div></div><p>or</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rgfopte[type() == &quot;ThreeD_StyleBooleanProperties&quot;]</span></div></div></div></div></div><p>Therefore, in order to access any other structure or property set
inside a .dvl or a .bdd file, this prefix has to be used</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">parent.rgfopte[type() == &quot;pib&quot;]</span></div></div></div></div></div><p><code>pib</code> being the name of the structure to which we want access.</p><hr><p>Developers: place your tips and hints here.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="-2013-glasswall-solutions-limited"></a>Â© 2013 Glasswall Solutions Limited<a aria-hidden="true" tabindex="-1" class="hash-link" href="#-2013-glasswall-solutions-limited" title="Direct link to heading">#</a></h2></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction" class="table-of-contents__link">1. Introduction</a></li><li><a href="#2-example-format" class="table-of-contents__link">2. Example Format</a></li><li><a href="#3-developer-hints-and-tips" class="table-of-contents__link">3. Developer Hints and Tips</a><ul><li><a href="#31---table-binaries-and-type--item-construct" class="table-of-contents__link">3.1 - Table Binaries and &quot;type * item&quot; construct</a></li><li><a href="#32-about-the-usage-of-restrictions-and-acceptrule-on-arrays" class="table-of-contents__link">3.2 About the usage of &#39;restrictions&#39; and &#39;AcceptRule&#39; on arrays</a></li><li><a href="#33-using-allowempty" class="table-of-contents__link">3.3 Using &#39;allowempty&#39;</a></li><li><a href="#34-bit-masking" class="table-of-contents__link">3.4 Bit Masking</a></li><li><a href="#35-where-you-have-a-string-defined-in-the-bdd-file" class="table-of-contents__link">3.5 Where you have a string defined in the BDD file</a></li><li><a href="#36-about-the-usage-of-optional" class="table-of-contents__link">3.6 About the usage of &#39;optional&#39;</a></li><li><a href="#37-accessing-a-specific-element-of-an-array" class="table-of-contents__link">3.7 Accessing a specific element of an array</a></li><li><a href="#38-accessing-ms-odraw-structures" class="table-of-contents__link">3.8 Accessing MS-ODRAW structures</a></li><li><a href="#39-accessing-ms-odraw-structures-further-explanation" class="table-of-contents__link">3.9 Accessing MS-ODRAW structures: Further explanation</a></li></ul></li><li><a href="#-2013-glasswall-solutions-limited" class="table-of-contents__link">Â© 2013 Glasswall Solutions Limited</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/glasswall-sdk-site/docs/products/cloud-sdk/rebuild/rebuild-quickstart">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/glasswall" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/filetrust" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/glasswallglobal" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/glasswall-solutions-limited/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Glasswall Solutions Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/glasswall-sdk-site/styles.d9e35366.js"></script>
<script src="/glasswall-sdk-site/runtime~main.0a1c7a3c.js"></script>
<script src="/glasswall-sdk-site/main.bca24aa5.js"></script>
<script src="/glasswall-sdk-site/1.b6c50131.js"></script>
<script src="/glasswall-sdk-site/2.afa770ea.js"></script>
<script src="/glasswall-sdk-site/159.dc6f6e54.js"></script>
<script src="/glasswall-sdk-site/160.57ee4261.js"></script>
<script src="/glasswall-sdk-site/935f2afb.168c9da0.js"></script>
<script src="/glasswall-sdk-site/17896441.61f115df.js"></script>
<script src="/glasswall-sdk-site/c30c321f.2aa2b98f.js"></script>
</body>
</html>