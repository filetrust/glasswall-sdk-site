---
title: 2.2.6.2.2 JavaScript 
sidebar_label: 2.2.6.2.2 JavaScript 
---

![](media/glasswalllogo.jpg)
<div style={{textAlign: 'center'}}>

# Glasswall API Language Wrapper Documentation
# JavaScript

&copy; 2020 Glasswall Solutions Ltd ALL RIGHTS RESERVED<br />
ALL RIGHTS RESERVED

Information contained herein is the property of Glasswall Limited and is proprietary and confidential.

Martin O'Brien

Glasswall Solutions Ltd.

[support@glasswallsolutions.com](mailto:support%40glasswallsolutions.com)
</div>


_Creation Date – 14 October 2020_

_Version – 1_

## Purpose

The purpose of the wrappers is to expose the Core 2 SDK functionality through Python, C#, JavaScript and Java.

Each wrapper consists of:

- The wrapper itself: a bridge between the Core 2 SDK and the desired language.
- A series of supporting files (language dependent).

## General Requirements

The following general requirements must be met to use the wrappers and their test apps:

- The Glasswall Core 2 libraries and their dependencies
  - glasswall\_core2.dll
  - \*\_camera.dll
- A designated folder containing files to be input into Core 2
- A designated folder to hold the output from Core 2
- A policy file to modify the default Core 2 file processing behaviour
- The wrapper itself.

## Test Application Overview

Each wrapper is provided with a test application. This application is designed to call each of the Core2 APIs from the chosen language and generate a log file of the results.
 The execution steps are:

- All supporting files, folders and dependencies are checked
- The contents of the output directory are erased in preparation for file processing
- For each file in the input directory:
  - A new folder is created in the output directory and is named for the file currently being processed
  - A series of 23 tests are performed, as detailed in the Wrapper Test Calls document
  - The files generated by Glasswall are saved in the specified output directory
  - A log file detailing the result of each test is generated and saved as local\_process\_log.txt
- When all files have been processed, a final log file named process\_log.txt is saved in the root of the output directory.

## JavaScript Wrapper

### Environment

- The JavaScript wrapper requires Node.js version 10.16.3. More recent versions of Node.js may not be compatible.
- Additional required modules are
  - node-ffi (Node.js Foreign Function Interface). The Node.js addon for loading and calling dynamic link libraries.
  - ref, the native addon for Node.js. This extends the Buffer class.
  - The node\_modules directory contents, as supplied.

Ensure the Core 2 libraries and all required folders are accessible to the wrapper.

### Example Code

The following code uses the JavaScript wrapper to process a file and place the managed file in a buffer. A policy file is specified, and an analysis report is generated. Note that the memory buffer is non-persistent and will have to be processed, analysed, or stored, before the script finishes. The policies file, config\_sanitise.xmlwill be placed in the specified directory.

```javascript
const fs = require('fs');
const path = require('path');
const ref = require('ref');
 
function main() {
   
    let glasswall = require("c:\\demo\\Core2JS.js");
    let gw = new glasswall("e:\\demo\\glasswall_core2.dll");
    
    try { 
        // open session
        let session_id = gw.GW2OpenSession();
 
        // register inputfile
        let return_status = gw.GW2RegisterInputFile(session_id, 'e:\\TestFiles\\C.bmp');
        
        // register outputmemory: the processed data is non-persistent
        let output_file_buffer = ref.alloc(ref.refType(ref.types.CString));
        let output_buffer_size = ref.alloc(ref.types.size_t, 0);
        return_status = gw.GW2RegisterOutputMemory(session_id, output_file_buffer,
            output_buffer_size);
 
        // register policies file
        return_status = gw.GW2RegisterPoliciesFile(session_id,
            'e:\\Tasks\\W57240-Core_2_JavaScript_Wrapper\\Src\\config_sanitise.xml', 0);
 
        // register analysis file
        return_status = gw.GW2RegisterAnalysisFile(session_id,
            'e:\\Output\\Analysis_output.xml', 0);  // 0 = AF_XML
 
        // run the session
        return_status = gw.GW2RunSession(session_id);
         
        // close the session
        return_status = gw.GW2CloseSession(session_id);
 
    }
    catch (err) {
        console.log(`error - exception caught: ${err}`);
        process.exit();
    }
}
 
if (require.main === module) {
    main();
}
```