(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{141:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return p}));var a=n(2),r=n(6),i=(n(0),n(233)),l={title:"DVL Guide"},b={unversionedId:"artifacts/DVLGuide",id:"artifacts/DVLGuide",isDocsHomePage:!1,title:"DVL Guide",description:"&copy; 2017 Glasswall Solutions Ltd",source:"@site/docs/artifacts/DVLGuide.md",slug:"/artifacts/DVLGuide",permalink:"/glasswall-sdk-site/docs/artifacts/DVLGuide",version:"current",sidebar:"someSidebar",previous:{title:"DVL Checker",permalink:"/glasswall-sdk-site/docs/artifacts/DvlChecker"},next:{title:"ExtractStrLit",permalink:"/glasswall-sdk-site/docs/artifacts/ExtractStrLit"}},c=[{value:"1. Overview",id:"1-overview",children:[{value:"1.1 Syntax",id:"11-syntax",children:[]},{value:"1.2 Values",id:"12-values",children:[]},{value:"1.3 Validation",id:"13-validation",children:[]}]},{value:"2 Work Item Template Wording",id:"2-work-item-template-wording",children:[]},{value:"3. Substructures",id:"3-substructures",children:[]},{value:"4. Syntax",id:"4-syntax",children:[{value:"4.1 General Notes",id:"41-general-notes",children:[]},{value:"4.2 Comments",id:"42-comments",children:[]}]},{value:"5. Functions",id:"5-functions",children:[{value:"5.1 Office Word Functions",id:"51-office-word-functions",children:[]},{value:"5.2 General Functions",id:"52-general-functions",children:[]}]},{value:"6. Flags",id:"6-flags",children:[{value:"6.1 MUST_IGNORE",id:"61-must_ignore",children:[]},{value:"6.2 IS_VALID",id:"62-is_valid",children:[]},{value:"6.3 EXISTS",id:"63-exists",children:[]},{value:"6.4 NOT_EXISTS",id:"64-not_exists",children:[]},{value:"6.5 TBD",id:"65-tbd",children:[]},{value:"6.6 NO_REQUIREMENT",id:"66-no_requirement",children:[]}]},{value:"7. Content Management Functions",id:"7-content-management-functions",children:[{value:"7.1 META(field, countofbytestoclear, fillChar)",id:"71-metafield-countofbytestoclear-fillchar",children:[]},{value:"7.2 HYPERLINK(field, countofbytestoclear, fillChar)",id:"72-hyperlinkfield-countofbytestoclear-fillchar",children:[]},{value:"7.3 REMEDY(field, countofbytestoclear, fillChar)",id:"73-remedyfield-countofbytestoclear-fillchar",children:[]},{value:"7.4 EMBEDDED(field, countofbytestoclear, fillChar)",id:"74-embeddedfield-countofbytestoclear-fillchar",children:[]},{value:"7.5 MACRO(field, countof bytestoclear, fillChar)",id:"75-macrofield-countof-bytestoclear-fillchar",children:[]},{value:"7.6 REJECTED(field, contenttype)",id:"76-rejectedfield-contenttype",children:[]}]},{value:"8. CONDITIONALS",id:"8-conditionals",children:[]},{value:"9. DEFINE",id:"9-define",children:[{value:"9.1 Plain DEFINE",id:"91-plain-define",children:[]},{value:"9.2 Macro DEFINE",id:"92-macro-define",children:[]}]},{value:"10. Array Slicing",id:"10-array-slicing",children:[]},{value:"11. Special Tags",id:"11-special-tags",children:[{value:"11.1 %NOTE%",id:"111-note",children:[]}]},{value:"12. BinPath Expression Language",id:"12-binpath-expression-language",children:[]},{value:"13. Including Files",id:"13-including-files",children:[]},{value:"14. Tabs",id:"14-tabs",children:[]},{value:"15. Ternaries",id:"15-ternaries",children:[]},{value:"16. Accessing Enumeration Members",id:"16-accessing-enumeration-members",children:[]},{value:"17. Using Batch Files",id:"17-using-batch-files",children:[]},{value:"18. REFERENCES",id:"18-references",children:[]},{value:"APPENDIX 1. &#39;HOW TO&#39; and Examples",id:"appendix-1-how-to-and-examples",children:[]}],o={rightToc:c};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},o,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("div",{style:{textAlign:"center"}},Object(i.b)("p",null,"\xa9"," 2017 Glasswall Solutions Ltd",Object(i.b)("br",null),"\nALL RIGHTS RESERVED"),Object(i.b)("p",null,"Information contained herein is the property of Glasswall Limited and is\nproprietary and confidential."),Object(i.b)("p",null,"Martin O'Brien"),Object(i.b)("p",null,"Glasswall Solutions Ltd.")),Object(i.b)("p",null,"Creation Date -- 25 September 2013"),Object(i.b)("p",null,"Version -- 1"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Document History")),Object(i.b)("p",null,"Table 1: Document Change History"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Issue Date"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Issue Number"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Author"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"25 Sep 2013"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"1.0"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Martin O'Brien"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Version 1")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"08 Feb 2017"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"1.1"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Elvin Barreto-White"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Updated to use latest Glasswall template.")))),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Document Distribution")),Object(i.b)("p",null,"Table 2: Document Distribution"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Name"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Position"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Sam Hutton"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"CTO")))),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Copyright and Contact Details")),Object(i.b)("p",null,"The copyright in this work is vested in Glasswall Solutions Ltd, and the\ndocument is issued in confidence for the purpose for which it is\nsupplied. It must not be reproduced in whole or in part or used for\ntendering or manufacturing purposes except under agreement or with the\nconsent in writing of Glasswall Solutions Limited and then only on\ncondition that this notice is included in any such reproduction. No\ninformation as to the contents or subject matter of this document or any\npart thereof arising directly or indirectly there from shall be given\norally or in writing or communicated in any manner whatsoever to any\nthird part being an individual firm or company or any employee thereof\nwithout the prior consent in writing of Glasswall Solutions Limited."),Object(i.b)("p",null,"\xa9"," 2016 Glasswall Solutions Limited"),Object(i.b)("h2",{id:"1-overview"},"1. Overview"),Object(i.b)("p",null,"This guide is designed to help you write better Data Validation Language (DVL) code and produce DVL code that is consistent in style and therefore easier to maintain. It is also a reference for the syntax of DVL."),Object(i.b)("h3",{id:"11-syntax"},"1.1 Syntax"),Object(i.b)("p",null,"The general syntax of a rule is"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",Object(i.b)("inlineCode",{parentName:"p"},"validation")," ",Object(i.b)("em",{parentName:"p"},"struct_name")," ",Object(i.b)("inlineCode",{parentName:"p"},"{"),Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0",Object(i.b)("em",{parentName:"p"},"field_name")," ",Object(i.b)("inlineCode",{parentName:"p"},":=")," ",Object(i.b)("em",{parentName:"p"},"condition_expression"),Object(i.b)("inlineCode",{parentName:"p"},";"),Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","...",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0",Object(i.b)("inlineCode",{parentName:"p"},"}"),Object(i.b)("br",null)),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"field_name")," is the name of the field being validated."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},":=")," indicates what follows is the expression to be evaluated."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"condition_expression")," is an expression that when it evaluates to true means the field has valid content. It is based on the Miraplacid ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"http://www.binarydom.com/sdk/doc/binpath.shtml"}),"BinPath Expression Language"),", with some additions, detailed below.")),Object(i.b)("p",null,"Note that in previous versions of this guide this form of rule was permitted"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"A := 0;\n")),Object(i.b)("p",null,"or"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"A := 0 || 1 || 2;\n")),Object(i.b)("p",null,"Please ",Object(i.b)("strong",{parentName:"p"},"do not")," use these forms any more."),Object(i.b)("p",null,"Instead, fully qualify them"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"A := current == 0;\n")),Object(i.b)("p",null,"or"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"A := current==0 || current==1 || current==2;\n")),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Note well"),': Always remember the precedence of rules! The first rule for the use of parentheses is simply "If in doubt, parenthesize," but do learn enough about expressions so that you are in do doubt about ',Object(i.b)("inlineCode",{parentName:"p"},"a==b || c==d"),". Overuse of parentheses, as in ",Object(i.b)("inlineCode",{parentName:"p"},"(a==b) || (c==d)"),", decreases readability."),Object(i.b)("h3",{id:"12-values"},"1.2 Values"),Object(i.b)("p",null,"Values can be expressed in decimal and hexadecimal format using the standard C,\nC++, etc., formats. Plain, unadorned decimal digits for decimal:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"2345, 255, 78\n")),Object(i.b)("p",null,"and hexadecimal digits prefixed with ",Object(i.b)("inlineCode",{parentName:"p"},"0x"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"0x929, 0xFF, 0x4E\n")),Object(i.b)("p",null,"Uppercase ",Object(i.b)("inlineCode",{parentName:"p"},"A-F")," and lowercase ",Object(i.b)("inlineCode",{parentName:"p"},"a-f")," can be used interchangeably for hexadecimal values."),Object(i.b)("h3",{id:"13-validation"},"1.3 Validation"),Object(i.b)("p",null,"DVL is designed to validate the content of the fields. It does not\nconcern itself with issues with which an application such as Office Word is\nconcerned."),Object(i.b)("p",null,"DVL is not concerned with validation that has been dealt with by the\n",Object(i.b)("inlineCode",{parentName:"p"},"restrictions")," expression rule or the expression contained in the ",Object(i.b)("inlineCode",{parentName:"p"},"AcceptRule")," pseudo-item in its related BDDL file."),Object(i.b)("h2",{id:"2-work-item-template-wording"},"2 Work Item Template Wording"),Object(i.b)("p",null,"// TODO This needs updating to current practice"),Object(i.b)("p",null,"When creating a Work Item, ensure you create it as a task and use this\nformat for the Title:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","Create DVL file for ",Object(i.b)("em",{parentName:"p"},"structure-name")),Object(i.b)("p",null,"This will make searches simpler."),Object(i.b)("p",null,"As with the BDDL Work Items, populate the fields so:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","Assigned To: ",Object(i.b)("em",{parentName:"p"},"Your name"),Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","Activity: Development",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","Area: Glasswall\\BDDL Development\\Office 1997-2007\\MS-DOC",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","Iteration: 13",Object(i.b)("em",{parentName:"p"},"nn")," ","[","where ",Object(i.b)("em",{parentName:"p"},"nn")," is the current iteration number","]",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","State: Active",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","Reason: New"),Object(i.b)("p",null,"Remember that the description field can be used to make more detailed\ncomments about the structure you are developing. For example, you might\nwant to mention some other structures that are included in your main\nstructure. You can also attach files to the Work Item. Anything that\nhelps other developers, and you, is worth adding to the Work Item."),Object(i.b)("h2",{id:"3-substructures"},"3. Substructures"),Object(i.b)("p",null,"If structure ",Object(i.b)("em",{parentName:"p"},"A")," contains structure ",Object(i.b)("em",{parentName:"p"},"B"),", then put ",Object(i.b)("em",{parentName:"p"},"B")," into a separate DVL\nfile, but ensure you update the \"Validation Files Log\" file\naccordingly by completing the 'Substructure' column."),Object(i.b)("h2",{id:"4-syntax"},"4. Syntax"),Object(i.b)("h3",{id:"41-general-notes"},"4.1 General Notes"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"If there is no MUST rule, use the ",Object(i.b)("inlineCode",{parentName:"p"},"NO_REQUIREMENT")," flag.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Leave ",Object(i.b)("inlineCode",{parentName:"p"},"TBD")," as a flag to indicate further development is required (for example, if the MUST rule is too complex).")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"There is no need to append the structure name before each member:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"Pms {\n    wpms := NO_REQUIREMENT; # valid\n    ...\n}\n")))),Object(i.b)("p",null,"Also, the DVL checker raises an error if a dot is used before the ",Object(i.b)("inlineCode",{parentName:"p"},":="),"."),Object(i.b)("h3",{id:"42-comments"},"4.2 Comments"),Object(i.b)("p",null,"Comments can be inserted into DVL with a hash ",Object(i.b)("inlineCode",{parentName:"p"},"#"),". The DVL parser will discard the # symbol and ignore everythign following it up to the end of the line."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"# This is a comment\n")),Object(i.b)("h2",{id:"5-functions"},"5. Functions"),Object(i.b)("p",null,"Function names do not have an underscore between the words, and are in uppercase."),Object(i.b)("p",null,"Functions also can be used as arguments to other functions, for example:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"ipfnpmf := ISIN(current, 0xFF, RANGE(current, 0x00, 0x05));\n")),Object(i.b)("p",null,"Do not put a space between the function name and the opening paranthesis."),Object(i.b)("h3",{id:"51-office-word-functions"},"5.1 Office Word Functions"),Object(i.b)("h4",{id:"511-versionword-version"},"5.1.1 VERSION(word-version)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Boolean"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": Return true if the current document is the version of Office Word indicated by ",Object(i.b)("em",{parentName:"p"},"word-version"),".\n",Object(i.b)("em",{parentName:"p"},"word-version")," can be one of:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Word1997"),Object(i.b)("li",{parentName:"ul"},"Word2000"),Object(i.b)("li",{parentName:"ul"},"Word2002"),Object(i.b)("li",{parentName:"ul"},"Word2003"),Object(i.b)("li",{parentName:"ul"},"Word2007")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),": You want to test if the current document is version 2000:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"VERSION(Word2000)\n")),Object(i.b)("h4",{id:"512-getcpcharcp"},"5.1.2 GETCPCHAR(CP)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Integer (width can vary)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": Retrieve the character specified by the character position ",Object(i.b)("inlineCode",{parentName:"p"},"CP")," and return it."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("p",null,"The requirement for field ",Object(i.b)("inlineCode",{parentName:"p"},"aCP")," in ",Object(i.b)("inlineCode",{parentName:"p"},"PlcfandRef")," as specified in ","[","MS-DOC","]"," \xa72.8.7 is:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",'"',Object(i.b)("em",{parentName:"p"},"Each position in the main document specified by one of these CPs MUST\nbe character 0x05",".","..The last CP MUST be ignored."),'"'),Object(i.b)("p",null,"This would be specified in DVL as:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"aCP[0..count(aCP)-2] := GETCPCHAR(current) == 5;\n")),Object(i.b)("h3",{id:"52-general-functions"},"5.2 General Functions"),Object(i.b)("h4",{id:"521-range-field-min-max"},"5.2.1 RANGE (field, min, max)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Boolean"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": If the content of ",Object(i.b)("inlineCode",{parentName:"p"},"field")," has any of the values in the\nrange ",Object(i.b)("inlineCode",{parentName:"p"},"min")," to ",Object(i.b)("inlineCode",{parentName:"p"},"max")," inclusive, the function returns true, otherwise it\nreturns false. For example, the specification for ",Object(i.b)("inlineCode",{parentName:"p"},"Pmfs.ipfnpmf")," says:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",'"',Object(i.b)("em",{parentName:"p"},"An unsigned integer value that specifies the type of data source for\nthe mail merge. This MUST be one of the following values: 0xFF, 0x00,\n0x01, 0x02, 0x03, 0x04, and 0x05."),'"'),Object(i.b)("p",null,"In DVL this can be represented as:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"ipfnpmf := 0xFF || RANGE(current, 0x00, 0x05);\n")),Object(i.b)("p",null,"or"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"ipfnpmf := ISIN(current, RANGE(current, 0x00, 0x05), 0xFF);\n")),Object(i.b)("h4",{id:"522-isin-field-val1-val2"},"5.2.2 ISIN (field, val1, val2,...)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Boolean"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": If the content of ",Object(i.b)("inlineCode",{parentName:"p"},"field")," has any of the values listed,\nthe function returns true, otherwise it returns false. For example, the\nspecification for ",Object(i.b)("inlineCode",{parentName:"p"},"Wpms.wpmsType")," says:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",'"',Object(i.b)("em",{parentName:"p"},"An unsigned integer that specifies the document type of the mail\nmerge. This value MUST be one of the following: 0x0, 0x1, 0x2, 0x4, and 0x8."),'"'),Object(i.b)("p",null,"In DVL this can be represented as:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"wpmsType := ISIN(current, 0x0, 0x1, 0x2, 0x4, 0x8);\n")),Object(i.b)("p",null,"or"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"wpmsType := ISIN((current, 0, 1, 2, 4, 8);\n")),Object(i.b)("p",null,"or"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"wpmsType := ISIN((current, RANGE (current, 0, 2) 4, 8);\n")),Object(i.b)("h4",{id:"523-isin_strfield-val1-val2-"},"5.2.3 ISIN_STR(field, val1, val2, ...)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Boolean"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": If the content of string ",Object(i.b)("inlineCode",{parentName:"p"},"field")," has any of the values\nlisted, the function returns true, otherwise it returns false. ",Object(i.b)("inlineCode",{parentName:"p"},"val1"),", ",Object(i.b)("inlineCode",{parentName:"p"},"val2"),", etc. must be strings."),Object(i.b)("p",null,"For example:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),'xml_tag1 := ISIN_STR(current, "ALPHA", "BETA", "GAMMA");\n')),Object(i.b)("h4",{id:"524-regexfield-regex"},"5.2.4 REGEX(field, regex)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Boolean"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": If the regular expression in ",Object(i.b)("inlineCode",{parentName:"p"},"regex")," matches the content of\nstring ",Object(i.b)("inlineCode",{parentName:"p"},"field")," the function returns TRUE, otherwise it returns FALSE."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"For example"),":"),Object(i.b)("p",null,"Search for a line comprised only of a decimal digit followed by one or more spaces:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),'xml_tag2 := REGEX(current, "^\\d\\w+$");\n')),Object(i.b)("h4",{id:"525-unique---todo-place-argument-list-here-also-the-example-is-not-clear"},"5.2.5 UNIQUE  (// TODO: place argument list here; also the example is not clear)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Boolean"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": Determine whether the value of a field is unique\nwithin all the structures specified."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),": Field ",Object(i.b)("inlineCode",{parentName:"p"},"ltag")," MUST be unique for all ",Object(i.b)("inlineCode",{parentName:"p"},"ATNBE"),"s inside a given\n",Object(i.b)("inlineCode",{parentName:"p"},"SttbfAtnBkmk"),". This will be written like this:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"lTag := UNIQUE(ATNBE);\n")),Object(i.b)("h4",{id:"526-exists-not-yet-implemented-as-of-version-13--todo-clarify-if-this-is-implemented"},"5.2.6 EXISTS (Not Yet Implemented as of version 1.3) (// TODO Clarify if this is implemented)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return Type"),": Boolean"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Description"),": Determine whether the named node exists in the\nBinary DOM tree. It returns TRUE if it does exist, otherwise it returns\nFALSE."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"hsttbRfs := current==0 ? !EXISTS(root.tableStream.Pms.sttbfRfs)\n    : EXISTS(root.tableStream.Pms.sttbfRfs)\n    ;\n")),Object(i.b)("h2",{id:"6-flags"},"6. Flags"),Object(i.b)("p",null,"Flag names have an underscore between the words."),Object(i.b)("h3",{id:"61-must_ignore"},"6.1 MUST_IGNORE"),Object(i.b)("p",null,"Specify the value must be ignored."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example 1"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"validation ... {\n    ...\n    unused1 := MUST_IGNORE;\n    ...\n}\n")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"MUST_IGNORE")," is like a switch; it allows some conditions to be ignored under certain circumstances."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example 2"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"var1 := condition1 && MUST_IGNORE;\n")),Object(i.b)("p",null,"Will apply the condition test. But we may optionally suppress the\nreport of an issue at the request of the client if these generate too\nmany false positives. In addition, if the condition is a test against\na fixed value (e.g ",Object(i.b)("inlineCode",{parentName:"p"},"var1 := current == 5"),") then we will 'Remedy' the\nfile by making that change."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example 3"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"var2 := condition2 ? MUST_IGNORE : condition3;\n")),Object(i.b)("p",null,"In this case, we simply apply ",Object(i.b)("inlineCode",{parentName:"p"},"condition3")," to ",Object(i.b)("inlineCode",{parentName:"p"},"var2")," if ",Object(i.b)("inlineCode",{parentName:"p"},"condition2"),"\nis false, ",Object(i.b)("inlineCode",{parentName:"p"},"MUST_IGNORE")," has no effect here."),Object(i.b)("h3",{id:"62-is_valid"},"6.2 IS_VALID"),Object(i.b)("hr",null),Object(i.b)("p",null,"Specify the value is valid. It is equivalent to ",Object(i.b)("inlineCode",{parentName:"p"},"NO_REQUIREMENT"),"."),Object(i.b)("h3",{id:"63-exists"},"6.3 EXISTS"),Object(i.b)("p",null,"Specifies the field exists. For example, the specification for the\n",Object(i.b)("inlineCode",{parentName:"p"},"tbcd")," field in the ",Object(i.b)("inlineCode",{parentName:"p"},"TBC")," structure says:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",'"',Object(i.b)("em",{parentName:"p"},"A structure of type TBCData, as specified in ","[","MS-OSHARED","]"," that\ncontains toolbar control data. This MUST exist if tbch.tct is not\nequal to 0x16. This MUST exist if tbch.tct is equal to 0x016."),'"'),Object(i.b)("p",null," In DVL this can be represented as:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"tbcd := tbch.tct != 0x16 ? EXISTS : NOT_EXISTS;\n")),Object(i.b)("h3",{id:"64-not_exists"},"6.4 NOT_EXISTS"),Object(i.b)("p",null,"Specify the value does not exist."),Object(i.b)("p",null,"See the example from ",Object(i.b)("inlineCode",{parentName:"p"},"EXISTS"),"."),Object(i.b)("h3",{id:"65-tbd"},"6.5 TBD"),Object(i.b)("p",null,"Specify the rule for the member has not been defined yet. If\nthere is no MUST rule for the member, replace ",Object(i.b)("inlineCode",{parentName:"p"},"TBD")," with ",Object(i.b)("inlineCode",{parentName:"p"},"NO_REQUIREMENT"),",\notherwise replace with the appropriate rule. Fields that have the ",Object(i.b)("inlineCode",{parentName:"p"},"TBD"),"\nflag will report an error."),Object(i.b)("h3",{id:"66-no_requirement"},"6.6 NO_REQUIREMENT"),Object(i.b)("p",null,"Specifies that there is no MUST rule that needs to be tested. Safe to\nuse with built in types (",Object(i.b)("inlineCode",{parentName:"p"},"uint8"),", ",Object(i.b)("inlineCode",{parentName:"p"},"int8"),", etc.) and user defined types\n(",Object(i.b)("inlineCode",{parentName:"p"},"Wpms"),", ",Object(i.b)("inlineCode",{parentName:"p"},"Pmfs"),", etc.)."),Object(i.b)("h2",{id:"7-content-management-functions"},"7. Content Management Functions"),Object(i.b)("h3",{id:"71-metafield-countofbytestoclear-fillchar"},"7.1 META(field, countofbytestoclear, fillChar)"),Object(i.b)("hr",null),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Usage")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"field := META(current, 10, 0x00);\n")),Object(i.b)("p",null,"Specify the marked object contains Metadata which can be blanked."),Object(i.b)("p",null,"Should be used only as specified on a line of its own."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"/* fcGrpXstAtnOwners specifies an offset in the Table Stream. An array\nof XSTs begins at this offset.\n\nThis array contains the names of authors of comments in the document.\n*/\n\nvalidation GrpXstAtnOwners {\n    Xst[0 .. count(Xst)] := META(current, (current.cch * 2), 0x00);\n}\n")),Object(i.b)("h3",{id:"72-hyperlinkfield-countofbytestoclear-fillchar"},"7.2 HYPERLINK(field, countofbytestoclear, fillChar)"),Object(i.b)("p",null,"// TODO This seems incorrect; needs clarification and a proper example"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Usage")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"field := META(current, 10, 0x00);\n")),Object(i.b)("p",null,"Specify the marked object contains Metadata which can be blanked."),Object(i.b)("p",null,"Should be used only as specified on a line of its own."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"/* fcGrpXstAtnOwners specifies an offset in the Table Stream. An\narray of XSTs begins at this offset. This array contains the names of\nauthors of comments in the document. */\n\nvalidation GrpXstAtnOwners {\n    Xst\\[0 .. count(Xst)\\] := META(current, (current.cch * 2), 0x00);\n}\n")),Object(i.b)("h3",{id:"73-remedyfield-countofbytestoclear-fillchar"},"7.3 REMEDY(field, countofbytestoclear, fillChar)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Usage"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"field := REMEDY(current, 10, 0x00);\n")),Object(i.b)("p",null,"Specify the marked object contains a datum which can be blanked."),Object(i.b)("p",null,"Should be used only as specified on a line of its own."),Object(i.b)("p",null,"This is used like ",Object(i.b)("inlineCode",{parentName:"p"},"HYPERLINK")," and ",Object(i.b)("inlineCode",{parentName:"p"},"META")," but applied to padding areas at the end of\nstructures or strings to clear data that is suggested to be undefined and ignorable."),Object(i.b)("h3",{id:"74-embeddedfield-countofbytestoclear-fillchar"},"7.4 EMBEDDED(field, countofbytestoclear, fillChar)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Usage"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"field := EMBEDDED(current, 10, 0x00);\n")),Object(i.b)("p",null,"Specify the marked object contains embedded data which can be\nblanked. Should be used only as specified on a line of its own."),Object(i.b)("p",null,"Used like ",Object(i.b)("inlineCode",{parentName:"p"},"HYPERLINK")," and ",Object(i.b)("inlineCode",{parentName:"p"},"META")," but applied to padding areas at the end of\nstructures or strings to clear data that is suggested to be undefined\nand ignorable."),Object(i.b)("h3",{id:"75-macrofield-countof-bytestoclear-fillchar"},"7.5 MACRO(field, countof bytestoclear, fillChar)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Usage")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"field := MACRO(current, 10, 0x00);\n")),Object(i.b)("p",null,"Specify the marked object contains macro data which can be\nblanked. Should be used only as specified on a line of its own."),Object(i.b)("p",null,"Used like all other Mark and Convert Functions but applied to data\nstructures, fields, records that either contain Macro content, or\nflags/values that imply Macros are present, which may trigger a\nProduct to start looking for actual Macros that we have removed and\nwarning user of their presence erroneously."),Object(i.b)("h3",{id:"76-rejectedfield-contenttype"},"7.6 REJECTED(field, contenttype)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Usage")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"field := REJECTED(current, MC_EMBEDDEDFILE);\n")),Object(i.b)("p",null,"Specify the marked object contains data which can be removed\nfrom the output file. Should be used only as specified on a line of\nits own."),Object(i.b)("p",null,"Used like all other Mark and Convert Functions but applied to\ndata structures, fields, records that contain manageable\ncontent. It works by setting ",Object(i.b)("inlineCode",{parentName:"p"},"ucpObjectProcessStatus")," in the\ncurrent structure to ",Object(i.b)("inlineCode",{parentName:"p"},"eUcpObjectStatus_CheckedAndRejected"),"; therefore,\nwhen the file is regenerated, this object and any of its children\nwill NOT be written to the output file."),Object(i.b)("p",null,'This is intended to be used with text based file formats such as XML or\nRTF so that we can cleanly remove "block start - data - block end"\nentities.'),Object(i.b)("p",null,"The type of the content is marked using the ",Object(i.b)("inlineCode",{parentName:"p"},"contenttype")," parameter which\nMUST be one of the following:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"MC_EMBEDDED_FILE"),Object(i.b)("li",{parentName:"ul"},"MC_METADATA"),Object(i.b)("li",{parentName:"ul"},"MC_HYPERLINK"),Object(i.b)("li",{parentName:"ul"},"MC_FORMDATA"),Object(i.b)("li",{parentName:"ul"},"MC_MACRO")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Important Note")),Object(i.b)("p",null,"Although you attach this rule to a field, that field must be a\nstructure object and not a scalar object; this is because we need to set the\n",Object(i.b)("inlineCode",{parentName:"p"},"ucpObjectProcessStatus")," field in the base of that object."),Object(i.b)("h2",{id:"8-conditionals"},"8. CONDITIONALS"),Object(i.b)("p",null,"Conditionals can be created with the following syntax:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",Object(i.b)("em",{parentName:"p"},"member")," := ",Object(i.b)("em",{parentName:"p"},"condition")," ? ",Object(i.b)("em",{parentName:"p"},"expression1")," : ",Object(i.b)("em",{parentName:"p"},"expression2"),";"),Object(i.b)("p",null,"This is equivalent to:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","if (",Object(i.b)("em",{parentName:"p"},"condition"),")",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",Object(i.b)("em",{parentName:"p"},"member")," := ",Object(i.b)("em",{parentName:"p"},"expression1"),";",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","else",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",Object(i.b)("em",{parentName:"p"},"member")," := ",Object(i.b)("em",{parentName:"p"},"expression2"),";"),Object(i.b)("p",null,"Note that ",Object(i.b)("inlineCode",{parentName:"p"},"if ... else ...")," is not available in DVL and is used for illustration only."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"For example:")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"sttbfRfs := rfs.hsttbRfs == 0 ? MUST_IGNORE : IS_VALID;\n")),Object(i.b)("p",null,"In this example, ",Object(i.b)("inlineCode",{parentName:"p"},"Pms.sttbfRfs")," is ignored when ",Object(i.b)("inlineCode",{parentName:"p"},"parent.rfs.hsttbRfs")," is\nequal to 0, otherwise it is valid."),Object(i.b)("p",null,"Conditionals can be nested to create more complex rules. The following\nformat should be used stack them:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",Object(i.b)("em",{parentName:"p"},"field1")," := ",Object(i.b)("em",{parentName:"p"},"condition1")," ? ",Object(i.b)("em",{parentName:"p"},"expression1"),Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",": ",Object(i.b)("em",{parentName:"p"},"condition2")," ? ",Object(i.b)("em",{parentName:"p"},"expression2"),Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",";"),Object(i.b)("p",null,"Which is equivalent to:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","if (",Object(i.b)("em",{parentName:"p"},"condition1"),")",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",Object(i.b)("em",{parentName:"p"},"field")," := ",Object(i.b)("em",{parentName:"p"},"expression1"),";",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","else if (",Object(i.b)("em",{parentName:"p"},"condition2"),")",Object(i.b)("br",null),"\n","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","field := ",Object(i.b)("em",{parentName:"p"},"expression2"),";"),Object(i.b)("p",null,"Note that ",Object(i.b)("inlineCode",{parentName:"p"},"if ... else ...")," is not available in DVL and is used for illustration only."),Object(i.b)("p",null,"See ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"#15-ternaries"}),"Section 15")," for further explanation of how to indent Ternary Operators."),Object(i.b)("h2",{id:"9-define"},"9. DEFINE"),Object(i.b)("h3",{id:"91-plain-define"},"9.1 Plain DEFINE"),Object(i.b)("p",null,"Some expressions will be repeated, and it makes sense to define them\nonce and use that definition. The syntax is"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","DEFINE ",Object(i.b)("em",{parentName:"p"},"name")," = ",Object(i.b)("em",{parentName:"p"},"expression"),";"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"For example"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"DEFINE ktCid = 0;\nDEFINE ktChar = 1;\nDEFINE ktMask = 3;\n")),Object(i.b)("p",null,"Then later on:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"validation Kme {\n    ...\n    param := ISIN(kt, ktCid, ktChar, ktMask);\n    ...\n}\n")),Object(i.b)("p",null,"This is useful only if you're likely to need ",Object(i.b)("inlineCode",{parentName:"p"},"ktCid"),", ",Object(i.b)("inlineCode",{parentName:"p"},"ktChar"),", or ",Object(i.b)("inlineCode",{parentName:"p"},"ktMask"),"\nmore than once in the same DVL file."),Object(i.b)("h3",{id:"92-macro-define"},"9.2 Macro DEFINE"),Object(i.b)("p",null,'DVL allows "templates" to be created using place holders.'),Object(i.b)("p",null,"The format is:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","DEFINE ",Object(i.b)("em",{parentName:"p"},"functionname"),"(%1, %2 ....) = {",Object(i.b)("em",{parentName:"p"},"BDDL_expression"),"};"),Object(i.b)("p",null,"For example:"),Object(i.b)("p",null,"// I inserted underscores in the macro names to make it readable; validate this is OK"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"DEFINE CALC_NUM_PLCS(%1, %2) = {(%1 - 4) / (4 + %2)};\n")),Object(i.b)("p",null,"Which can be used like this:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"CALC_NUM_PLCS(field, 8);\n")),Object(i.b)("p",null,"Which will be converted to:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"{(field - 4) / (4 + 8)};\n")),Object(i.b)("p",null,"This is a more realistic example:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"CALC_NUM_PLCS(root.wordDocStream.fib.fibRgFcLcbBlob.fibRgFcLcb97.lcbPlcfBtePapx, 2);\n")),Object(i.b)("p",null,"The value returned will be the number of data elements in that PLC\n(assuming the size of a single data element in this example is 2)."),Object(i.b)("h2",{id:"10-array-slicing"},"10. Array Slicing"),Object(i.b)("p",null,"// TODO Array slicing here does not conform to the half-open ranges in other languages such as the end() function in C++'s containers, and Python's range() function; not sure if it's worth mentioning. It does conform to Perl's range operator."),Object(i.b)("p",null,"In DVL it is possible to reference several elements of an array\nsimultaneously using the '..' (double-dot) notation. For example"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"aCP[0 .. 4]\n")),Object(i.b)("p",null,"is the same as"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"aCP[0]\naCP[1]\naCP[2]\naCP[3]\naCP[4]\n")),Object(i.b)("p",null,"Array slicing makes sense when comparing elements of two arrays, or the\nsame array, simultaneously, for example:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"arr[0 .. max_index-1] := current < arr[1 .. max_index];\n")),Object(i.b)("p",null,"This will test that"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"arr[0] < arr[1];\narr[1] < arr[2];\n...\narr[max_index-1] < arr[max_index];\n")),Object(i.b)("p",null,"In other words, it tests that the array contents are in ascending order."),Object(i.b)("p",null,"The same validation can be achieved by this expression:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"arr := arr[0..max_index-1] < arr[1..max_index];\n")),Object(i.b)("p",null,"As another example, if you want to check each element is greater than 0:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"arr[0 .. max_index] := current > 0;\n")),Object(i.b)("p",null,"The important thing to remember is that for an expression, each array\nslice generates a loop, so, consider this rather contrived example:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"arr[0..max_index-2] := arr[1..max_index-1] < arr[2..max_index];\n")),Object(i.b)("p",null,"Will generate"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"arr[0] := arr[1] < arr[2];\narr[1] := arr[2] < arr[3];\n...\narr[max_index-2] := arr[max_index-1] < arr[max_index];\n")),Object(i.b)("h2",{id:"11-special-tags"},"11. Special Tags"),Object(i.b)("h3",{id:"111-note"},"11.1 %NOTE%"),Object(i.b)("p",null,"In order to facilitate the parsing of any issues that may need further\nconsideration, prefix any specification with ",Object(i.b)("inlineCode",{parentName:"p"},"%NOTE%")," as the first part of\na comment."),Object(i.b)("p",null,"When using the ",Object(i.b)("inlineCode",{parentName:"p"},"%NOTE%")," option, leave the field the note refers to as ",Object(i.b)("inlineCode",{parentName:"p"},"TBD"),"\nand DO NOT change it to ",Object(i.b)("inlineCode",{parentName:"p"},"NO_REQUIREMENT")," which is incorrect in that\ncircumstance."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("p",null,"In ",Object(i.b)("em",{parentName:"p"},"Ttmbd.dvl")," the field ",Object(i.b)("inlineCode",{parentName:"p"},"fcSubset"),' can be any value, but the specification\nsays, "',Object(i.b)("em",{parentName:"p"},"This value MUST NOT exceed the total number of fonts used in the\ndocument."),'" This may need to be validated later, so this is how it is\nspecified in the DVL:'),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"# %NOTE% This value MUST NOT exceed the total number of\n# fonts used in the document.\nfcSubset := TBD;\n")),Object(i.b)("h2",{id:"12-binpath-expression-language"},"12. BinPath Expression Language"),Object(i.b)("p",null,"The facilities of Miraplacid's ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"http://www.binarydom.com/sdk/doc/binpath.shtml"}),"BinPath Expression Language")," are\navailable to use in DVL. For example, if you require a count of elements\nin an array, you can use the  ",Object(i.b)("inlineCode",{parentName:"p"},"count")," function:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"# validate that aCP is in ascending order\n# NOTE: count is number of elements, so index ranges from\n# 0 to count-1.\n\naCP[0..count(aCP)-1] := aCP[0..count(aCP)-2] < aCP[1..count(aCP)-1];\n")),Object(i.b)("p",null,"Refer to the ",Object(i.b)("em",{parentName:"p"},"Binary DOM Library")," document on the Wiki for a list of\nall the functions and details of how to use the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"http://www.binarydom.com/sdk/doc/binpath.shtml"}),"BinPath Expression Language"),"."),Object(i.b)("h2",{id:"13-including-files"},"13. Including Files"),Object(i.b)("p",null,"In order to group commonly used ",Object(i.b)("inlineCode",{parentName:"p"},"DEFINE"),"s you can use the ",Object(i.b)("inlineCode",{parentName:"p"},"include"),"\nconstruct to tell the DVL parser to search for matches to defines in the\nnamed files. The syntax is:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0",'include "',Object(i.b)("em",{parentName:"p"},"filepath"),'"'),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),'include "office_dvl/common/PlcDefines.dvl"\n')),Object(i.b)("p",null,"// TODO Provide valid links to items referenced below"),Object(i.b)("p",null,"This assumes a softlink has been created. See the document ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"howto_softlink_to_office_bddl_includes_dir"}),"How to Create Soft Link for Office BDDL Include Files"),", but change the name of the soft link you create\nto ",Object(i.b)("inlineCode",{parentName:"p"},"office_dvl")," and the target directory to ",Object(i.b)("em",{parentName:"p"},"your",Object(i.b)("em",{parentName:"em"},"workspace_directory"),"\npath"),Object(i.b)("inlineCode",{parentName:"p"},"\\glasswall.classic\\data.definitions.and.rules\\MSOffice\\validation\\"),"."),Object(i.b)("h2",{id:"14-tabs"},"14. Tabs"),Object(i.b)("p",null,"Tabs do not appear the same when printed on different output devices, or\npasted into a word-processor document, or even just viewed in someone\nelse's differently tab spaced editor. Do not use tab characters in\nDVL files."),Object(i.b)("p",null,"Most editors allow the insertion of spaces when the Tab key is pressed\nand you should set your editor to do this. Four space indentation should\nbe used, so set the editor to insert four spaces."),Object(i.b)("h2",{id:"15-ternaries"},"15. Ternaries"),Object(i.b)("p",null,"If you are creating long expressions using the ternary operator, use\nthis style of indentation:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"# An example of cascaded ternary operator, using field in Selsf\nblktblSel := (L==0 && N==0) ? MUST_IGNORE\n    : (L==0 && N==1) ? NO_REQUIREMENT\n    : (L==1 && N==0) ? NO_REQUIREMENT\n    : (L==1 && N==1) ? NO_REQUIREMENT\n;\n")),Object(i.b)("p",null,"Note how the terminating semicolon is lined up separately to make it\nclear the statement has finished."),Object(i.b)("p",null,"If you have a final result (which has no preceding question mark) indent\nit so that it too lines up in the results column."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"# An example of cascaded ternary operator, using field in Selsf\nfInsEnd := current == 1 ? P == 1\n    : I == 1 ? current == MUST_IGNORE\n    : 0\n    ;\n")),Object(i.b)("p",null,"You can use the tabular layout even if you have only a single ternary:"),Object(i.b)("p",null,"// TODO This example looks like it's lifted directly from Perl: provide better one"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"A := (current==0) ? $customer{name}\n    : 'Sir or Madam'\n    ;\n")),Object(i.b)("h2",{id:"16-accessing-enumeration-members"},"16. Accessing Enumeration Members"),Object(i.b)("p",null,"When an item is defined as an enumeration in BDD, the matching DVL must\nindicate to which type the rule is being applied by adding a means of\nselecting the type using a notation that provides the type."),Object(i.b)("p",null,"// TODO The '$' below looks out of place. Confirm it's correct."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"items.child$type\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example"),":"),Object(i.b)("p",null,"BDD"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"struct Cid {\n    (CidAllocated | CidMacro | CidFci | uint32) cid;\n}\n\nstruct TBDelta {\n    ...\n    Cid cid;\n    ...\n}\n")),Object(i.b)("p",null,"DVL"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"validation TBDelta {\n    ...\n    cid := ISIN(cid.cid\\$uint32, 1, 3);\n    ...\n    cid := sizeof(cid.cid$CidAllocated) < 200; /* example for demo only, not part of the real DVL in this case */\n    ...\n}\n")),Object(i.b)("p",null,"This means that the rule is applied to the ",Object(i.b)("inlineCode",{parentName:"p"},"cid.cid")," field and treated as\nthe ",Object(i.b)("inlineCode",{parentName:"p"},"uint32")," type. It is the responsibly of the writer to ensure that the\nrule is applied only in a context where the field is of the type being\ntested."),Object(i.b)("h2",{id:"17-using-batch-files"},"17. Using Batch Files"),Object(i.b)("p",null,"Using batch files in\n",Object(i.b)("em",{parentName:"p"},"tfs"),"\\Features\\OFFICE","\\",Object(i.b)("em",{parentName:"p"},"branch"),"\\glasswall.classic\\data.definitions.and.rules\\BDD_DVL_to_code_scripts"),Object(i.b)("p",null,"There are two fundamental batch files in this support directory:"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","generate_",Object(i.b)("em",{parentName:"p"},"filetype"),"_","cpp_from_bdd.bat"),Object(i.b)("p",null,"and"),Object(i.b)("p",null,"\xa0","\xa0","\xa0","\xa0","generate_",Object(i.b)("em",{parentName:"p"},"filetype"),"_","cpp_from_dvl.bat"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"generate_",Object(i.b)("em",{parentName:"p"},"filetype"),"_","cpp_from_bdd.bat - These batch files use the\n",Object(i.b)("em",{parentName:"p"},"tfs"),"\\inhouse.tools\\GWPerlScripts\\BDD_to_Cpp_Convertor\\BDD_To_Cpp.pl\nPerl script to read the ",Object(i.b)("em",{parentName:"p"},".BDD files and create the matching "),".cpp\nand ",Object(i.b)("em",{parentName:"p"},".h files for each one, plus "),"_if.cpp and *_if.h files and support files for the root BDD.")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"generate_",Object(i.b)("em",{parentName:"p"},"filetype"),"_","cpp_from_dvl.bat - These batch files use\n",Object(i.b)("em",{parentName:"p"},"tfs"),"\\inhouse.tools\\GWBinaryAnalysisTools\\UCP_Struct_Rule_Converters\\dvl_tools\\dvl_checker","\\","Releases\\Latest_Version\\dvl_checker.exe to read the ",Object(i.b)("em",{parentName:"p"},".BDD files and "),".DVL files and create the validation *.cpp file containing all of the validation methods for each structure in the BDD files."))),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note well"),": These batch files default to using ",Object(i.b)("em",{parentName:"p"},"dvl_checker.exe")," defined in environment variable ",Object(i.b)("inlineCode",{parentName:"p"},"PATH_TO_DVLCHECKER")," which they set to the one mentioned\nin this paragraph if ",Object(i.b)("inlineCode",{parentName:"p"},"PATH_TO_DVLCHECKER")," is unset. "),Object(i.b)("p",null,"// TODO The following sentence does not make sense, please clarify."),Object(i.b)("p",null,"(For testing ",Object(i.b)("em",{parentName:"p"},"use_ucp_dvlchecker.bat")," pre-sets ",Object(i.b)("inlineCode",{parentName:"p"},"PATH_TO_DVLCHECKER")," to a different\ndvl_checker version so you can call that before running the DVL\nprocessing batch file on which you are working)."),Object(i.b)("h2",{id:"18-references"},"18. REFERENCES"),Object(i.b)("p",null,"DVL Guide ","[this guide]"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Glasswall")," > ",Object(i.b)("strong",{parentName:"p"},"BDDL Development")," > ",Object(i.b)("strong",{parentName:"p"},"Validation")," > ",Object(i.b)("strong",{parentName:"p"},"DVL Guide")),Object(i.b)("p",null,"Validation Files Log"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Glasswall")," >",Object(i.b)("strong",{parentName:"p"}," BDDL Development")," > ",Object(i.b)("strong",{parentName:"p"},"Validation")," > ",Object(i.b)("strong",{parentName:"p"},"Validation Files Log")),Object(i.b)("p",null,"Binary DOM Library"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Glasswall")," > ",Object(i.b)("strong",{parentName:"p"},"BDDL Development")),Object(i.b)("h2",{id:"appendix-1-how-to-and-examples"},"APPENDIX 1. 'HOW TO' and Examples"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example 1")," - What information in a specification to place in a DVL Rule"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"The specification")),Object(i.b)("p",null,"2.9.343 VertMergeOperand"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"cb (1 byte): An integer value that specifies the byte count of the\nremainder of this structure. This value MUST be 2.\n\nitc (1 byte): An integer that specifies the index of a cell in the\ntable row. The first cell has an index of zero. All cells in the row\nare counted, even if they are vertically merged with cells above or\nbelow them. This value MUST be a valid index of a cell in the table\nrow.\n\nvertMergeFlags (1 byte): A value from the VerticalMergeFlag\nenumeration that specifies whether this cell is vertically merged\nwith the cells above or below it.\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"The DVL")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"validation VertMergeOperand {\n    cb := 2;\n    # %NOTE% itc An integer that specifies the index of a cell in\n    # the table row.\n    itc := NO_REQUIREMENT;\n    vertMergeFlags := ISIN(current, 0, 1, 3);\n}\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Explanation"),":"),Object(i.b)("p",null,"It is important to note validation statements in the DVL even if you\ncannot see how they might be implemented."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example 2")," - Avoiding out of bounds on arrays"),Object(i.b)("p",null,"This rule suffers from a problem if the ",Object(i.b)("inlineCode",{parentName:"p"},"my_array_name")," is zero in quantity"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"rulename := my_array_name[count(my_array_name)-1] != 0;\n")),Object(i.b)("p",null,"Please ensure that you prefix the test with a test for ",Object(i.b)("inlineCode",{parentName:"p"},"count(my_array_name) > 0")," before trying to do the test."),Object(i.b)("p",null,"This version checks there is at least one item in the array before\ntrying to find the last one."),Object(i.b)("p",null,"Otherwise simply return true regardless."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"rulename := count(my_array_name) > 0 ? my_array_name[count(my_array_name)-1] != 0\n: 1\n;\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example 3")," - Testing presence of scalars"),Object(i.b)("p",null,"If an item is a single byte field, the ",Object(i.b)("inlineCode",{parentName:"p"},"EXISTS")," and ",Object(i.b)("inlineCode",{parentName:"p"},"NOT_EXISTS")," tests does not\napply because scalar fields are inserted as permanent members of classes; therefore, the DVL test on it below is of no use."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"For example"),":"),Object(i.b)("p",null,"This structure has a single-byte padding field"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"struct LPUpxChpx {\n    AcceptRule (parent.parent.parent.stdf.stdfBase.cupx_istdNext & 0x000F) > 0;\n    uint16 cbUpx;\n    UpxChpx CHPX optional;\n    uint8 padding optional restrictions {parent.cbUpx % 2 != 0};\n}\n")),Object(i.b)("p",null,'So an "existence test" will not work and is redundant.'),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"For example"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"validation LPUpxChpx {\n    cbUpx := NO_REQUIREMENT;\n    CHPX := NO_REQUIREMENT;\n\n    padding := cbUpx % 2 != 0 ? EXISTS : NOT_EXISTS;  # This Test made no sense and was removed.\n\n}\n")))}p.isMDXComponent=!0},233:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return O}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=r.a.createContext({}),p=function(e){var t=r.a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):b(b({},t),e)),n},s=function(e){var t=p(e.components);return r.a.createElement(o.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,o=c(e,["components","mdxType","originalType","parentName"]),s=p(n),u=a,O=s["".concat(l,".").concat(u)]||s[u]||d[u]||i;return n?r.a.createElement(O,b(b({ref:t},o),{},{components:n})):r.a.createElement(O,b({ref:t},o))}));function O(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=u;var b={};for(var c in t)hasOwnProperty.call(t,c)&&(b[c]=t[c]);b.originalType=e,b.mdxType="string"==typeof e?e:a,l[1]=b;for(var o=2;o<i;o++)l[o]=n[o];return r.a.createElement.apply(null,l)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);