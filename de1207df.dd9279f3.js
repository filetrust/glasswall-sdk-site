(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{245:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return p}));var n=a(2),r=a(6),c=(a(0),a(281)),o={title:"3.8 Core 2 Cameras - Creating and Development Rules",sidebar_label:"3.8 Core 2 Cameras - Creating and Development Rules"},l={unversionedId:"3-guides/3_8-core2-cameras-creating_and_developing_rules",id:"3-guides/3_8-core2-cameras-creating_and_developing_rules",isDocsHomePage:!1,title:"3.8 Core 2 Cameras - Creating and Development Rules",description:"| Steven Warner",source:"@site/docs/3-guides/3_8-core2-cameras-creating_and_developing_rules.md",slug:"/3-guides/3_8-core2-cameras-creating_and_developing_rules",permalink:"/glasswall-sdk-site/docs/3-guides/3_8-core2-cameras-creating_and_developing_rules",version:"current",sidebar_label:"3.8 Core 2 Cameras - Creating and Development Rules",sidebar:"someSidebar",previous:{title:"3.7 STOP VM Image User Guide",permalink:"/glasswall-sdk-site/docs/3-guides/3_7-using_stop"},next:{title:"3.9 Using Qt in Glasswall",permalink:"/glasswall-sdk-site/docs/3-guides/3_9-using_qt_in_glasswall"}},s=[{value:"Core2 cameras - Creating and Development Rules",id:"core2-cameras---creating-and-development-rules",children:[]},{value:"Building a Core2 Camera",id:"building-a-core2-camera",children:[{value:"Check BDD",id:"check-bdd",children:[]},{value:"Prepare batchfiles",id:"prepare-batchfiles",children:[]},{value:"Generation",id:"generation",children:[]},{value:"Validation Callback and Issue ID / Sanity ID / Group ID",id:"validation-callback-and-issue-id--sanity-id--group-id",children:[]},{value:"Adding New Camera to Core2 Project",id:"adding-new-camera-to-core2-project",children:[]}]},{value:"Pitfalls",id:"pitfalls",children:[]},{value:"Policies",id:"policies",children:[{value:"Naming conventions",id:"naming-conventions",children:[]}]}],i={rightToc:s};function p(e){var t=e.components,o=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(n.a)({},i,o,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"| Steven Warner\n|\n| --- |"),Object(c.b)("table",null,Object(c.b)("thead",{parentName:"table"},Object(c.b)("tr",{parentName:"thead"},Object(c.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Glasswall Solutions Ltd"))),Object(c.b)("tbody",{parentName:"table"})),Object(c.b)("p",null,"|"),Object(c.b)("h3",{id:"core2-cameras---creating-and-development-rules"},"Core2 cameras - Creating and Development Rules"),Object(c.b)("p",null," |\n| How to build and maintain Core2 style cameras |"),Object(c.b)("h2",{id:"building-a-core2-camera"},"Building a Core2 Camera"),Object(c.b)("h3",{id:"check-bdd"},"Check BDD"),Object(c.b)("p",null,"Confirm ","'",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"#_Naming_conventions"}),"Naming conventions"),"'"," in ","'","Policies","'"," section adhered to"),Object(c.b)("p",null,"First check is that Miraplacid data viewer works with the BDD and you have run a decent number of test files through BDDLDirectoryReader to confirm the BDD is sound when parsing documents"),Object(c.b)("h3",{id:"prepare-batchfiles"},"Prepare batchfiles"),Object(c.b)("p",null,"Create a setup","_","(cameraname).bat in ..\\glasswall.classic\\data.definitions.and.rules\\BDD","_","DVL","_","to","_","code","_","scripts if it does not yet exist"),Object(c.b)("p",null,"See ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"#_Setup_Batch_Sample"}),"sample")," for expected form"),Object(c.b)("h3",{id:"generation"},"Generation"),Object(c.b)("p",null,"New Generator script - generate","_","code","_","core2.bat"),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"Usage generate","_","code","_","core2.bat ",'"',"tfs","_","path",'"'," ",'"',"cameraname",'"'," ",'"',"toolversion",'"'," ",'["',"optional code params",'"]')),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"where ",'"',"tfs","_","path",'"'," is the path to your workspace e.g. c:\\tfs2013")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"where ",'"',"cameraname",'"'," is one of the camera types e.g. emf,wmf,msdoc,msppt,msxls,printersetting,rtf,equationnative etc")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"where ",'"',"toolversion",'"'," is bdd-to-cpp tool and C# dvl","_","checker tool located in")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"'","ucp","'"," - default ",'"',"\\","STORAGE-SERVER\\Development Drive\\Development Tools\\UCP","_","ToolChain",'"'," directory")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"'","ucp","_","pending","'"," - ",'"',"\\","STORAGE-SERVER\\Development Drive\\Development Tools\\UCP","_","ToolChain\\Pending",'"'," directory")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"'","ucp","_","previous","'"," - ",'"',"\\","STORAGE-SERVER\\Development Drive\\Development Tools\\UCP","_","ToolChain\\Previous",'"'," directory")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"'","ucp","_","local","'"," - ",'"',"c:\\UCP","_","ToolChain.Local",'"'," directory, for recently rebuild tool output. Usually for development.")),Object(c.b)("p",null,"It takes the same parameters as generate","_","code.bat but always inserts ","'","\u2014core2","'"," option so that BDDs should still be able to be built in Classic for maintenance."),Object(c.b)("p",null,"The output goes to a different temporary directory:"),Object(c.b)("p",null,"It creates a ",'"',"temporary","_","generate","_","output.core2",'"'," directory"),Object(c.b)("p",null,"For each camera two directories are produced e.g."),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"mp3")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"mp3.support")),Object(c.b)("p",null,"The intent is to keep the root directory (mp3 in this case) for generated output that will be tried to be kept unaltered when copied across to the project."),Object(c.b)("p",null,"The support directory, contains code that is partially populated ready for more hand inserted sections. (will try and place markers to help clarify)"),Object(c.b)("p",null,"If a generated camera is going to be heavily altered for interim work (such as reusing a classic camera) then a cameraname.hybrid directory should be created to mix the generated and hand built parts. Eg"),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"mp3.hybrid")),Object(c.b)("h3",{id:"validation-callback-and-issue-id--sanity-id--group-id"},"Validation Callback and Issue ID / Sanity ID / Group ID"),Object(c.b)("h4",{id:"sample-of-porting-tiff"},"Sample of porting: Tiff"),Object(c.b)("p",null,"Call back code needs to be wrapped in an object to ensure no global static data is used."),Object(c.b)("p",null,"The ID mapping functions from Classic are usable and just need linking to the standard Core2 Camera interface."),Object(c.b)("p",null,"The source code for Issue (aka Err) ID / Sanity ID / Group ID needs to be copied from classic generated area to the core2 \\","<","cameraname\\",">",".support directory"),Object(c.b)("h1",{id:"1"},"1"),Object(c.b)("p",null,"For completeness, a Sanitise map was created for Tiff to show the sequence of construction."),Object(c.b)("p",null,"All filenames changed to all lowercase to help removed complaints from Linux when filename case differs."),Object(c.b)("p",null,Object(c.b)("img",{src:a(466).default})),Object(c.b)("p",null,"Add existing files menu"),Object(c.b)("p",null,"Add the new files"),Object(c.b)("p",null," ",Object(c.b)("img",{src:a(467).default})),Object(c.b)("p",null," ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"#sdfootnote1anc"}),"1")," \\","<","cameraname\\",">",".support directory is usually expected to need careful merging with updated support template code when you regenerate the camera from BDD"),Object(c.b)("p",null,"New files then part of project:"),Object(c.b)("p",null,Object(c.b)("img",{src:a(468).default})),Object(c.b)("p",null,"Next step is to make a few changes to the code to remove ","'","C","'"," and old classic headers, then connect the functions to \\","<","camera\\",">","_","support","_","functions.cpp"),Object(c.b)("p",null,"ErrMsg ID changes"),Object(c.b)("p",null,Object(c.b)("img",{src:a(469).default})),Object(c.b)("p",null,Object(c.b)("img",{src:a(470).default})),Object(c.b)("p",null,"GroupMsg ID changes"),Object(c.b)("p",null,Object(c.b)("img",{src:a(471).default})),Object(c.b)("p",null,Object(c.b)("img",{src:a(472).default})),Object(c.b)("p",null,"SanitisationMsg ID changes"),Object(c.b)("p",null,Object(c.b)("img",{src:a(473).default})),Object(c.b)("p",null,Object(c.b)("img",{src:a(474).default})),Object(c.b)("p",null,"Support Functions Changes"),Object(c.b)("p",null,Object(c.b)("img",{src:a(475).default})),Object(c.b)("h3",{id:"adding-new-camera-to-core2-project"},"Adding New Camera to Core2 Project"),Object(c.b)("p",null,"Project (PRO files)"),Object(c.b)("p",null,"There are several PRO (project) files that control the construction of the code:"),Object(c.b)("p",null,"Adding new cameras."),Object(c.b)("p",null,"\u2026\\glasswall.core2\\core2.pro"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-c++"}),"TEMPLATE = subdirs\n\n#project name to project file mapping where name and directory are different\nooxml.file = cameras/camera.pool/ooxml/officexml.pro\nbmp.file = cameras/camera.pool/bmp/BMP.pro\n\u2026\n\n#Active subproject list : comment these out to remove from current build\nSUBDIRS  = core.support \\\n           core2.dll \\\n           qt_core2_dataviewer \\\n           opc \\\n           mp3 \\\n           mp4 \\\n           wav \\\n\u2026\n\n\nCONFIG += ordered\n\n# alternative project name to project file mapping\n# where project name is same as dirctory name\ncore2.dll.subdir = core2.dll\ncore.support.subdir = core.support\nqt_core2_dataviewer.subdir = qt_core2_dataviewer\ntiff.subdir = cameras/camera.pool/tiff\nopc.subdir = cameras/camera.pool/opc\nmp3.subdir = cameras/camera.pool/mp3\n\u2026\n\n\n# Project dependancies\ncore2.dll.depends = core.support\nqt_core2_dataviewer.depends = core.support\ntiff.depends = core.support core2.dll\nopc.depends = core.support core2.dll\nmp3.depends = core.support core2.dll\n\n")),Object(c.b)("h2",{id:"pitfalls"},"Pitfalls"),Object(c.b)("p",null,"Code generator has removed and tidied a lot of boiler-plate code in the generated output. So expect subtle differences from Classic output"),Object(c.b)("p",null,"Also some methods of grabbing data have changed to more compact forms."),Object(c.b)("p",null,"It","'","s still a work in progress, so some new bugs have been introduced while trying to improve its reinterpretation of BDDL expressions."),Object(c.b)("h2",{id:"policies"},"Policies"),Object(c.b)("h3",{id:"naming-conventions"},"Naming conventions"),Object(c.b)("h4",{id:"include-files"},"Include files"),Object(c.b)("p",null,"Intent where possible the generated files will stick to lowercase for filenames to avoid Linux complaints about different files when case is changed."),Object(c.b)("h4",{id:"root-file-namesdirectories"},"Root file names/directories"),Object(c.b)("p",null,"You must make sure there is a simple and consist naming of the key directory and root objects"),Object(c.b)("h5",{id:"bdd-sample-mp3"},"BDD Sample MP3"),Object(c.b)("p",null,"Main BDD same name as the camera and in same named directory."),Object(c.b)("p",null,"\u2026\\glasswall.classic\\data.definitions.and.rules\\AUDIO\\bddl\\ ",Object(c.b)("strong",{parentName:"p"},"MP3")," \\ ",Object(c.b)("strong",{parentName:"p"},"mp3"),".bdd"),Object(c.b)("p",null,"BDD contains a Document object for Miraplacid to open the file :"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),'[extension="mp3", mime_type="glasswall/mp3", ft_t="ft_mp3"]\ndocument MP3Root {\n    MP3 mp3;\n}\n\n')),Object(c.b)("p",null,"But this is not used as kick off point for the Code Generator, instead it will use a root class as specified in the camera batch file \u2013 but for convention that should also be the same name."),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"struct MP3 {\n    ID3V2Tag id3v2Tag optional;\n    Frame [*] frames;\n    ID3V1Tag id3v1Tag optional;\n    APETag apeTag optional;\n}\n\n")),Object(c.b)("h5",{id:"dvl-sample-mp3"},"DVL Sample MP3"),Object(c.b)("p",null,"c:\\tfs-2013\\Glasswall\\Features\\Core2\\Task49532","_","StartCore2DLL\\glasswall.classic\\data.definitions.and.rules\\AUDIO\\validation\\MP3\\mp3.dvl"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"validation MP3 {\nid3v2Tag := NO_REQUIREMENT;\n}\n\n")),Object(c.b)("h5",{id:"setup-batch-sample-mp3"},"Setup Batch Sample MP3"),Object(c.b)("p",null,"c:\\tfs-2013\\Glasswall\\Features\\Core2\\Task49532","_","StartCore2DLL\\glasswall.classic\\data.definitions.and.rules\\BDD","_","DVL","_","to","_","code","_","scripts\\setup","_","mp3.bat"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),'pushd ..\nset CD_PARENT=%CD%\npopd\n\nset "PATH_TO_BDD=%CD_PARENT%\\Audio\\bddl\\MP3\\mp3.bdd"\nset "PATH_TO_DVL=%CD_PARENT%\\Audio\\validation\\MP3"\nset "BDD_ROOT=MP3"\n\nset "CODEOPTIONS= --enable_dataheap --core2"\nset "DVLOPTIONS= --core2"\n\n')),Object(c.b)("p",null,Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"#sdendnote1anc"}),"i")," Note BDDs are still in glasswall.classic directory \u2026 probably should be moved up level at some point"))}p.isMDXComponent=!0},281:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=r.a.createContext({}),p=function(e){var t=r.a.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=p(e.components);return r.a.createElement(i.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,c=e.originalType,o=e.parentName,i=s(e,["components","mdxType","originalType","parentName"]),d=p(a),u=n,m=d["".concat(o,".").concat(u)]||d[u]||b[u]||c;return a?r.a.createElement(m,l(l({ref:t},i),{},{components:a})):r.a.createElement(m,l({ref:t},i))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var c=a.length,o=new Array(c);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var i=2;i<c;i++)o[i]=a[i];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"},466:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot1-5f36cf515fbb26556d08d1fc3477f982.png"},467:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot2-edf7dcb595de06359644cc290996fd2c.png"},468:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot3-845b4e2e3d926ed851c5c545aeb0c0fe.png"},469:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot4-bf85d65811f0b2ce5bcd59e140672ee1.png"},470:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot5-1140cd1989abb78c903f58dfd51ad389.png"},471:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot6-f5039446b48b015913113051e2fa6c9d.png"},472:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot7-801d7173f5af5da193449171fae2d0b7.png"},473:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot8-22cca68903fc33054de97fc34dfa5af6.png"},474:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot9-758d55a25f7d1b84d05c0a84134dc69b.png"},475:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/screenshot10-eea2f26aad6f5b80c8b1136b86f768e1.png"}}]);