(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{278:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var r=n(0),a=n.n(r);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),p=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(n),b=r,h=u["".concat(i,".").concat(b)]||u[b]||d[b]||s;return n?a.a.createElement(h,l(l({ref:t},c),{},{components:n})):a.a.createElement(h,l({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=b;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<s;c++)i[c]=n[c];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},285:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/glasswalllogo-253631de638aaac23c1c3221945b5994.jpg"},61:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return o})),n.d(t,"default",(function(){return p}));var r=n(2),a=n(6),s=(n(0),n(278)),i={title:"2.1.7.2.3 C#",sidebar_label:"2.1.7.2.3 C#"},l={unversionedId:"2-glasswall_core/2_1-glasswall_rebuild/2_1_7-sdk/2_1_7_2-sdk_wrappers/2_1_7_2_3-c_sharp",id:"2-glasswall_core/2_1-glasswall_rebuild/2_1_7-sdk/2_1_7_2-sdk_wrappers/2_1_7_2_3-c_sharp",isDocsHomePage:!1,title:"2.1.7.2.3 C#",description:"Glasswall API Language Wrapper Documentation",source:"@site/docs/2-glasswall_core/2_1-glasswall_rebuild/2_1_7-sdk/2_1_7_2-sdk_wrappers/2_1_7_2_3-c_sharp.md",slug:"/2-glasswall_core/2_1-glasswall_rebuild/2_1_7-sdk/2_1_7_2-sdk_wrappers/2_1_7_2_3-c_sharp",permalink:"/glasswall-sdk-site/docs/2-glasswall_core/2_1-glasswall_rebuild/2_1_7-sdk/2_1_7_2-sdk_wrappers/2_1_7_2_3-c_sharp",version:"current",sidebar_label:"2.1.7.2.3 C#",sidebar:"someSidebar",previous:{title:"2.1.7.2.2 JavaScript",permalink:"/glasswall-sdk-site/docs/2-glasswall_core/2_1-glasswall_rebuild/2_1_7-sdk/2_1_7_2-sdk_wrappers/2_1_7_2_2-javascript"},next:{title:"2.1.7.2.4 Java",permalink:"/glasswall-sdk-site/docs/2-glasswall_core/2_1-glasswall_rebuild/2_1_7-sdk/2_1_7_2-sdk_wrappers/2_1_7_2_4-java"}},o=[{value:"1.1 Issues to consider during implementation",id:"11-issues-to-consider-during-implementation",children:[]},{value:"2.1 Files provided",id:"21-files-provided",children:[]},{value:"2.2 Framework dependencies",id:"22-framework-dependencies",children:[]},{value:"2.3 Wrapper integration",id:"23-wrapper-integration",children:[]},{value:"2.4 Code example",id:"24-code-example",children:[]},{value:"2.5 Issues to consider",id:"25-issues-to-consider",children:[]}],c={rightToc:o};function p(e){var t=e.components,i=Object(a.a)(e,["components"]);return Object(s.b)("wrapper",Object(r.a)({},c,i,{components:t,mdxType:"MDXLayout"}),Object(s.b)("p",null,Object(s.b)("img",{src:n(285).default})),Object(s.b)("div",{style:{textAlign:"center"}},Object(s.b)("h1",{id:"glasswall-api-language-wrapper-documentation"},"Glasswall API Language Wrapper Documentation"),Object(s.b)("h1",{id:"c"},"C#"),Object(s.b)("p",null,"\xa9"," 2020 Glasswall Solutions Ltd ALL RIGHTS RESERVED",Object(s.b)("br",null),"\nALL RIGHTS RESERVED"),Object(s.b)("p",null,"Information contained herein is the property of Glasswall Limited and is proprietary and confidential."),Object(s.b)("p",null,"Martin O'Brien"),Object(s.b)("p",null,"Glasswall Solutions Ltd."),Object(s.b)("p",null,Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"mailto:support%40glasswallsolutions.com"}),"support@glasswallsolutions.com"))),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"Creation Date \u2013 14 October 2020")),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"Version \u2013 1")),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Copyright and Contact Details")),Object(s.b)("p",null,"The copyright in this work is vested in Glasswall Solutions Ltd, and the document is issued in confidence for the purpose for which it is supplied. It must not be reproduced in whole or in part or used for tendering or manufacturing purposes except under agreement or with the consent in writing of Glasswall Solutions Limited and then only on condition that this notice is included in any such reproduction. No information as to the contents or subject matter of this document or any part thereof arising directly or indirectly there from shall be given orally or in writing or communicated in any manner whatsoever to any third part being an individual firm or company or any employee thereof without the prior consent in writing of Glasswall Solutions Limited."),Object(s.b)("p",null,"\xa9 Glasswall Solutions Limited 2020"),Object(s.b)("p",null,"If there are any questions related to this report, these should be addressed to:"),Object(s.b)("p",null,"Glasswall Solutions Limited"),Object(s.b)("p",null,"e-mail: ",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"mailto:support%40glasswallsolutions.com"}),"support@glasswallsolutions.com")),Object(s.b)("h1",{id:""}),Object(s.b)("h1",{id:"1-introduction"},"1 Introduction"),Object(s.b)("p",null,"This is an introductory guide on how to use the C# language wrapper for the Glasswall API."),Object(s.b)("p",null,"For each language we have provided the following:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"The required dependencies and the target platform or framework required for the language. The mentioned platforms and frameworks are the ones that were used during testing, but other versions may or may not work."),Object(s.b)("li",{parentName:"ul"},"A general overview on integrating Glasswall into a project."),Object(s.b)("li",{parentName:"ul"},"A code example demonstrating how the Glasswall library can be used to process a directory of files. Each example shows the file being processed in Manage and Protect mode as well as being analysed in Analysis mode.")),Object(s.b)("h2",{id:"11-issues-to-consider-during-implementation"},"1.1 Issues to consider during implementation"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"The Glasswall library is not thread safe, which means that the language wrappers are not thread safe. This can be overcome by running the Glasswall library in a separate process."),Object(s.b)("li",{parentName:"ul"},"We recommend that the Glasswall library is run in a separate process in case unforeseen issues arise.")),Object(s.b)("h1",{id:"2-c"},"2 C#"),Object(s.b)("h2",{id:"21-files-provided"},"2.1 Files provided"),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"glasswall.classic.csharp.dll")," \u2013 The C# wrapper is provided as a .Net Framework Class Library that can be integrated into a project and used to interact with the Glasswall library. There are two OS specific versions of the library: one for the Windows OS and one for the Linux OS. Please ensure that you reference the correct version depending on your target platform otherwise you will get a DllNotFoundException when trying to interact with Glasswall."),Object(s.b)("h2",{id:"22-framework-dependencies"},"2.2 Framework dependencies"),Object(s.b)("p",null,"The C# wrapper requires the .Net Framework 4.5 to be installed or a Mono equivalent."),Object(s.b)("h2",{id:"23-wrapper-integration"},"2.3 Wrapper integration"),Object(s.b)("p",null,"The wrapper can be integrated into a project by simply adding a reference to the wrapper Library. The wrapper library uses the DllImport attribute to load the Glasswall library, which means that the Glasswall library needs to be in the search path in order to be executed. More information can be found at ",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.mono-project.com/docs/advanced/pinvoke/"}),"https://www.mono-project.com/docs/advanced/pinvoke/")),Object(s.b)("h2",{id:"24-code-example"},"2.4 Code example"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-csharp"}),'using System;\nusing System.IO;\n\nusing GlasswallSolutions;\n\nnamespace glasswall.classic.csharp.testing\n{\n    class Program\n    {\n        public static void Main(string[] args)\n        {\n            string xmlConfigPath = args[0];    // The path to the XML content management configuration\n            string inputDirectory = args[1];   // The input directory\n            string outputDirectory = args[2];  // The output directory\n\n            // Print the Glasswall library version\n            Console.WriteLine("Library version: {0}", Glasswall.GWFileVersion());\n\n            Directory.CreateDirectory(outputDirectory);\n            string xmlConfig = File.ReadAllText(xmlConfigPath);\n\n            // Apply Content Management Configuration\n            if (Glasswall.GWFileConfigXML(xmlConfig) != 1)\n            {\n                // Print the failure reason\n                Console.WriteLine("Failed to load the XML config file: {0}", Glasswall.GWFileErrorMsg());\n                return;\n            }\n\n            foreach (string path in Directory.EnumerateFiles(inputDirectory, "*", SearchOption.AllDirectories))\n            {\n                Console.WriteLine("Processing file: {0}", path);\n                string outputPath = Path.Combine(outputDirectory, Path.GetFileNameWithoutExtension(path));\n\n                string extension = Path.GetExtension(path).Trim(\'.\'); // We use the file extension as the file type\n                int status = 0; // The file process status\n                byte[] fileProtect; // The buffer for the protected file\n\n                status = Glasswall.GWFileProtect(path, extension, out fileProtect); // Run the file through File to Memory Protect\n                PrintProcessInfo(status); // Print out the status\n                WriteAllBytes(outputPath + "." + extension, fileProtect); // Write the protected file\n\n                string analysisFile; // The analysis report\n                status = Glasswall.GWFileAnalysisAudit(path, extension, out analysisFile); // Analyse the file with File to Memory Analysis\n                PrintProcessInfo(status); // Print out the status\n                WriteAllText(outputPath + ".xml", analysisFile); // Write the analysis report\n            }\n\n            // Clean up any resources allocated by Glasswall\n            Glasswall.GWFileDone();\n        }\n\n        static void WriteAllBytes(string path, byte[] data)\n        {\n            if (data == null)   File.Create(path);\n            else                File.WriteAllBytes(path, data);\n        }\n\n        static void WriteAllText(string path, string data)\n        {\n            if (string.IsNullOrEmpty(data)) File.Create(path);\n            else                            File.WriteAllText(path, data);\n        }\n\n        static void PrintProcessInfo(int fileProcessStatus)\n        {\n            uint processStatus = 0;\n            \n            Glasswall.GWFileProcessStatus(ref processStatus); // Get the process status\n            Console.WriteLine("Process status: {0}", processStatus);\n            Console.WriteLine("Process message: {0}", Glasswall.GWFileProcessMsg()); // Print the file process message\n\n            if (fileProcessStatus != 1) Console.WriteLine("Glasswall error: {0}", Glasswall.GWFileErrorMsg()); // Print non-conformance reason\n        }\n    }\n}\n\n\n')),Object(s.b)("h2",{id:"25-issues-to-consider"},"2.5 Issues to consider"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Very large files can potentially cause Out of Memory Exceptions to occur when running in File to Memory mode. This is due to certain results being returned as byte arrays. Potential remedy is to process files in File to File mode."),Object(s.b)("li",{parentName:"ul"},"In very exceptional circumstances certain PDF documents may cause a StackOverflowException to occur. This can be mitigated by increasing the stack size of the application.")))}p.isMDXComponent=!0}}]);